---
title: 'TEMA 3: Regresiones dinámicas: modelos vectoriales autorregresivos (VAR)'
author:
  name: Julián Ramajo, ramajo@unex.es
  affiliation: GRADO EN ESTADÍSTICA | ECONOMETRIA (502243)
subtitle: 'Aplicación 3.7.b: Evolución temporal de los tipos de cambio'
output:
  html_document:
    theme: journal
    highlight: haddock
    toc: yes
    toc_depth: 2
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '2'
---

# Objetivo

En esta aplicación se estimará un modelo VAR para explicar la evolución en el tiempo de tres tipos de cambio.


# Código R

```{r}
# Lectura de datos
library(readxl)
data <- read_excel("TIPOS_CAMB.xls")
#
data$reur = c(NA,100*diff(log(data$EUR)))
data$rgbp = c(NA,100*diff(log(data$GBP)))
data$rjpy = c(NA,100*diff(log(data$JPY)))
#
data = data[-1,]
# Modelo VAR
library(vars)
VARselect(data[c("reur","rgbp","rjpy")], lag.max = 10)
VAR(data[c("reur","rgbp","rjpy")],p = 2)
#
var = VAR(data[c("reur","rgbp","rjpy")],p = 2)
#
causality(var,cause = c("rgbp","rjpy"))$Granger
causality(var,cause = c("reur","rjpy"))$Granger
causality(var,cause = c("reur","rgbp"))$Granger
# Funciones de respueta al impulso y de descomposición de la varianza
ir = irf(var,n.ahead = 20)
plot(ir)
#
vd = fevd(var,n.ahead = 20)
plot(vd)
```

# Código Python

```{python}
# Lectura de librerías
import pandas as pd
import numpy as np
import statsmodels.tsa.api as smt
import matplotlib.pyplot as plt
# Lectura de datos
data = pd.read_excel('TIPOS_CAMB.xls', index_col=0)
#
def LogDiff(x):
    x_diff = 100*np.log(x/x.shift(1))
    x_diff = x_diff.dropna()
    return x_diff
#
data = pd.DataFrame({'reur':LogDiff(data['EUR']),
                     'rgbp':LogDiff(data['GBP']),
                     'rjpy':LogDiff(data['JPY'])})
# Modelo VAR 
model = smt.VAR(data)
res = model.select_order(maxlags=10)
print(res.summary())
#
res = model.fit(maxlags=2)
print(res.summary())
# Funciones de respueta al impulso y de descomposición de la varianza
irf = res.irf(20)
fig = irf.plot()
plt.show()
#
fevd = res.fevd(20)
fig = fevd.plot()
plt.show()
```
