---
title: "Aplicación 0: Lectura, filtrado, selección, transformación y representación de datos en R con Tidyverse"
output:
  html_document:
    df_print: paged
---

# Código R

```{r}
library(tidyverse)
gapminder <- read_delim("GAPMINDER.csv", ";", escape_double = FALSE, trim_ws = TRUE)
head(gapminder)
#
library(skimr)
skim(gapminder)
#
# Operaciones básicas del Tidyverse
#
# "Verbos" de dplyr
#
# select
#
gapminder_selected <- select(gapminder, year, country, pop, gdpPercap)
#
# filter
#
gapminder_filtered <- filter(gapminder_selected, year>=1980)
#
# mutate
#
gapminder_mutated <- mutate(gapminder_filtered, GDP=gdpPercap*pop)
#
# group_by
#
gapminder_grouped <- group_by(gapminder_mutated, country)
#
# summarise
#
gapminder_summarised <- summarise(gapminder_grouped, AVG_GDP=mean(GDP))
#
# arrange
#
gapminder_arranged_ascending <- arrange(gapminder_summarised, AVG_GDP)
gapminder_arranged_descending <- arrange(gapminder_summarised, -AVG_GDP)
#
# El operador "tubería" (pipe) (%>%)
#
AVG_GDP <- 
  gapminder %>% 
  select(year, country, pop, gdpPercap) %>% 
  filter(year>=1980) %>% 
  mutate(GDP=gdpPercap*pop) %>% 
  group_by(country) %>% 
  summarise(AVG_GDP=mean(GDP)) %>% 
  arrange(-AVG_GDP)
#
# Gráficas y EDA
#
# GGally 
library(GGally)
#
gapminder %>% select(-country) %>% ggpairs()
#
# Regresión
#
model_1 <- lm(lifeExp ~ gdpPercap, data=gapminder)
summary(model_1)
#
model_2 <- lm(lifeExp ~ gdpPercap + year, data=gapminder)
summary(model_2)
#
library(lindia)
model_2 %>% 
  gg_diagnose(plot.all=TRUE,boxcox=TRUE)
#
model_3 <- lm(lifeExp ~ log(gdpPercap) + year, data=gapminder)
summary(model_3)
model_3 %>% 
  gg_diagnose(plot.all=TRUE,boxcox=TRUE)
#
```
