<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Econometría - Aplicación 3.12 (Variable dependiente discreta o limitada): Modelos Logit/Probit, Tobit y Heckit</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./p3c2-app13.html" rel="next">
<link href="./p3c2-app11.html" rel="prev">
<link href="./EconMetricsRPy-logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p3-mrl-extendido.html">CAPÍTULO 3: DIAGNOSIS, CORRECCIONES Y EXTENSIONES DEL MODELO DE REGRESIÓN LINEAL</a></li><li class="breadcrumb-item"><a href="./p3c2-app12.html">Aplicación 3.12 (Variable dependiente discreta o limitada): Modelos Logit/Probit, Tobit y Heckit</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Econometría</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/JulianRamajo/EconometriaRPy" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PREFACIO</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p0-aspectos-tecnicos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CAPÍTULO 0: ASPECTOS TÉCNICOS</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p0c1-setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instalación y configuración de R y Python en RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p0c2-rpy-comp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R versus Python: Comparación de lenguajes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p0c3-reticulate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programación conjunta en R y Python con reticulate</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p1-introduccion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CAPÍTULO 1: CONCEPTOS BÁSICOS</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1c1-teoria.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Conceptos básicos de la econometría</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1c2-app1a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 1.1.a (Gestión y representación gráfica de datos): Gramática básica del <em>tidyverse</em></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1c2-app1b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 1.1.b (Gestión y representación gráfica de datos): Gestión de datos con R y Python</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1c2-app2a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 1.2a (Gestión y representación gráfica de datos financieros): Propiedades estadísticas básicas de los activos bursátiles</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1c2-app2b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 1.2b (Gestión y representación gráfica de datos financieros): Relaciones entre activos bursátiles</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1c2-app3a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 1.3.a (Gestión y representación gráfica de datos espaciales): Emisiones de CO2 al nivel mundial</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1c2-app3b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 1.3b (Gestión y representación gráfica de datos espaciales): Desarrollo humano al nivel mundial</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1c2-app4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 1.4 (Regresiones con datos de corte transversal): Demanda familiar de carne</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1c2-app5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 1.5 (Regresiones con datos de series temporales): Consumo privado en Estados Unidos</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p2-mrl-basico.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CAPÍTULO 2: EL MODELO DE REGRESIÓN LINEAL Y SUS HIPÓTESIS BÁSICAS</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2c1-teoria.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">El modelo de regresión lineal y sus hipótesis básicas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2c2-app1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 2.1 (Estimación MCO y contrastes de hipótesis): Modelo CAPM para las acciones del Banco Santander</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2c2-app2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 2.2 (Predicción con el modelo de regresión lineal): Curva de Engel para el gasto en alimentos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2c2-app3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 2.3 (Modelo de regresión lineal con forma funcional polinómica): Curva de costes en el sector textil</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2c2-app4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 2.4 (Modelo de regresión lineal con términos de interacción): Efectos diferenciados de la publicidad sobre las ventas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2c2-app5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 2.5 (Modelo de regresión lineal con variables cualitativas): Brecha salarial entre hombres y mujeres en Estados Unidos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2c2-app6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 2.6 (Series temporales de alta frecuencia y estacionalidad): Demanda de electricidad en el estado de Victoria, Australia</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p3-mrl-extendido.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CAPÍTULO 3: DIAGNOSIS, CORRECCIONES Y EXTENSIONES DEL MODELO DE REGRESIÓN LINEAL</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c1-teoria.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Diagnosis, correcciones y extensiones del modelo de regresión lineal</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c2-app1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 3.1 (Evaluación, validación y especificación del MRL): El modelo APT de valoración de activos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c2-app2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 3.2 (Evaluación, validación y especificación del MRL): Ventas en una cadena de supermercados</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c2-app3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 3.3 (Estabilidad de los parámetros estructurales): Diferenciación salarial por sexo. Exportaciones españolas.</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c2-app4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 3.4 (No normalidad de los errores y observaciones atípicas): Muestra de datos con observaciones atípicas simuladas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c2-app5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 3.5 (Regresiones heteroscedásticas): Función de demanda con varianza no constante</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c2-app6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 3.6 (Regresiones con volatilidad variable en el tiempo): Relación entre los precios de los carburantes y el precio del petroleo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c2-app7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 3.7 (Autocorrelación y regresiones dinámicas): Modelos ARDL y VAR</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c2-app8a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 3.8a (Dependencia espacial - Geometría: polígonos): Estadísticas ‘morales’ en Francia en 1830</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c2-app8b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 3.8b (Dependencia espacial - Geometría: puntos): Precio de la vivienda en el condado de Lucas [Ohio, Estados Unidos]</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c2-app9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 3.9 (Información muestral - Falta de observaciones): Exclusión social en el comportamiento de las aseguradoras de Chicago</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c2-app10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 3.10 (Información muestral - Multicolinealidad): Análisis de la rentabilidad empresarial</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c2-app11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 3.11 (Regresores endógenos - El estimador de variables instrumentales: Determinantes de la inflación al nivel internacional</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c2-app12.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Aplicación 3.12 (Variable dependiente discreta o limitada): Modelos Logit/Probit, Tobit y Heckit</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c2-app13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 3.13 (Modelos econométricos para datos de panel): Productividad de la industria química en China</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BIBLIOGRAFÍA</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#variable-dependiente-discreta-modelos-logit-y-probit-préstamos-hipotecarios" id="toc-variable-dependiente-discreta-modelos-logit-y-probit-préstamos-hipotecarios" class="nav-link active" data-scroll-target="#variable-dependiente-discreta-modelos-logit-y-probit-préstamos-hipotecarios">Variable dependiente discreta (modelos Logit y Probit): Préstamos hipotecarios</a></li>
  <li><a href="#código-r" id="toc-código-r" class="nav-link" data-scroll-target="#código-r">Código R</a></li>
  <li><a href="#código-python" id="toc-código-python" class="nav-link" data-scroll-target="#código-python">Código Python</a></li>
  <li><a href="#variable-dependiente-limitada-valores-censurados---modelo-tobit-compra-de-automóviles" id="toc-variable-dependiente-limitada-valores-censurados---modelo-tobit-compra-de-automóviles" class="nav-link" data-scroll-target="#variable-dependiente-limitada-valores-censurados---modelo-tobit-compra-de-automóviles">Variable dependiente limitada (valores censurados -&gt; modelo Tobit): Compra de automóviles</a></li>
  <li><a href="#código-r-1" id="toc-código-r-1" class="nav-link" data-scroll-target="#código-r-1">Código R</a></li>
  <li><a href="#código-python-1" id="toc-código-python-1" class="nav-link" data-scroll-target="#código-python-1">Código Python</a></li>
  <li><a href="#variable-dependiente-limitada-truncamiento-selectivo---modelo-heckit-de-selección-muestral-salarios-de-las-mujeres-casadas" id="toc-variable-dependiente-limitada-truncamiento-selectivo---modelo-heckit-de-selección-muestral-salarios-de-las-mujeres-casadas" class="nav-link" data-scroll-target="#variable-dependiente-limitada-truncamiento-selectivo---modelo-heckit-de-selección-muestral-salarios-de-las-mujeres-casadas">Variable dependiente limitada (truncamiento selectivo -&gt; modelo Heckit de selección muestral): Salarios de las mujeres casadas</a></li>
  <li><a href="#código-r-2" id="toc-código-r-2" class="nav-link" data-scroll-target="#código-r-2">Código R</a></li>
  <li><a href="#código-python-2" id="toc-código-python-2" class="nav-link" data-scroll-target="#código-python-2">Código Python</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Aplicación 3.12 (Variable dependiente discreta o limitada): Modelos Logit/Probit, Tobit y Heckit</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">
<style type="text/css">
.justify { text-align: justify !important }
</style>
</div>
<section id="variable-dependiente-discreta-modelos-logit-y-probit-préstamos-hipotecarios" class="level2 unnumbered justify">
<h2 class="unnumbered anchored" data-anchor-id="variable-dependiente-discreta-modelos-logit-y-probit-préstamos-hipotecarios">Variable dependiente discreta (modelos Logit y Probit): Préstamos hipotecarios</h2>
<p>En un artículo del año 1987, Dhillon y otros autores estudiaron el conjunto de características personales y financieras que determinan la elección por parte de los individuos de un tipo de interés fijo frente a uno variable a la hora de contratar un préstamo hipotecario. El interés de su trabajo radicaba en contrastar las dos posturas que dominan los planteamientos teóricos sobre el tema: la primera de ellas opina que, de acuerdo con la <em>hipótesis de mercados eficientes</em>, las características personales del prestatario no contienen información que no haya sido ya tenida en cuenta por el mercado a la hora de fijar el tipo de interés y, por tanto, sólo las variables de precios y los términos del contrato serían relevantes cuando un individuo elige el tipo de interés que se le aplicará; la segunda escuela de pensamiento supone que existe <em>información asimétrica</em>, es decir, dadas las condiciones del mercado, los prestatarios pueden favorecerse no revelando algunas de sus características personales a la hora de firmar el contrato.</p>
<p>El modelo propuesto relaciona la probabilidad de que un individuo elija, dadas sus características personales y las condiciones del mercado, un tipo de interés variable frente a uno fijo para un préstamo hipotecario. Se dispone de una muestra de 78 clientes de un banco hipotecario norteamericano. Del total de observaciones, 46 eligieron un tipo de interés fijo (con vencimiento de 30 años) y 32 un tipo de interés variable (no acotado).</p>
<p>Las variables disponibles para estimar el modelo son las siguientes:</p>
<ul>
<li><p>Variable dependiente: <span class="math inline">\(Y\)</span> toma el valor 1 si el individuo elige un tipo de interés variable y 0 si firma el préstamo a un tipo fijo.</p></li>
<li><p>Variables explicativas del mercado: <span class="math inline">\(FI\)</span> es el tipo de interés fijo que ofertó el banco, <span class="math inline">\(MARG\)</span> el margen del tipo fijo sobre el tipo de interés variable, <span class="math inline">\(YLD\)</span> la diferencia entre el tipo de interés de las letras del tesoro a 10 años y el tipo de las letras a 1 año (esta variable intenta anticipar el cambio futuro en los tipos de interés a corto plazo), <span class="math inline">\(PTS\)</span> la razón entre el tipo de interés fijo y el variable, y <span class="math inline">\(MAT\)</span> la razón entre los vencimientos de los préstamos hipotecarios con tipo fijo y variable.</p></li>
<li><p>Variables explicativas personales: <span class="math inline">\(BA\)</span> es la edad del prestatario, <span class="math inline">\(BS\)</span> los años de escolarización, <span class="math inline">\(FTB\)</span> una variable ficticia que toma el valor 1 si el prestatario compra vivienda por primera vez y 0 en otro caso, <span class="math inline">\(CB\)</span> una ficticia que toma el valor 1 si existe un co-prestatario y 0 en otro caso, <span class="math inline">\(MC\)</span> una ficticia que toma el valor 1 si el prestatario está casado y 0 si no lo está, <span class="math inline">\(SE\)</span> una ficticia que toma el valor 1 si trabaja por cuenta propia y 0 en otro caso, <span class="math inline">\(MOB\)</span> el número de años que el prestatario lleva residiendo en la dirección actual, <span class="math inline">\(NW\)</span> la riqueza neta, <span class="math inline">\(LA\)</span> los activos líquidos, y <span class="math inline">\(STL\)</span> los compromisos económicos del prestatario a corto plazo.</p></li>
</ul>
<p>El modelo econométrico general que se estimará tiene la siguiente expresión:</p>
<p><span class="math display">\[Y_{i} = \beta_1 + \beta_2 FI_{i} + \beta_3 MARG_{i} + \beta_4 YLD_{i} + \beta_5 PTS_{i} + \beta_6 MAT_{i} +\]</span> <span class="math display">\[+ \beta_7 BA_{i} + \beta_8 BS_{i} + \beta_9 FTB_{i} + \beta_{10} CB_{i} + \beta_{11} MC_{i} + \]</span> <span class="math display">\[+ \beta_{12} SE_{i} + \beta_{13} MOB_{i} + \beta_{14} NW_{i} + \beta_{15} LA_{i} + \beta_{16} STL_{i} + e_{i}\]</span></p>
</section>
<section id="código-r" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="código-r">Código R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lectura de librerías</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(alr4)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(margins)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Lectura de datos</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>PREST_HIP <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/PREST_HIP.csv"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(PREST_HIP)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       BA              BS              CB              FI       
 Min.   :24.00   Min.   : 6.00   Min.   :0.000   Min.   :11.76  
 1st Qu.:31.00   1st Qu.:14.00   1st Qu.:0.000   1st Qu.:12.50  
 Median :36.50   Median :16.00   Median :0.000   Median :13.50  
 Mean   :36.04   Mean   :16.45   Mean   :0.359   Mean   :13.25  
 3rd Qu.:40.50   3rd Qu.:18.00   3rd Qu.:1.000   3rd Qu.:13.75  
 Max.   :65.00   Max.   :25.00   Max.   :1.000   Max.   :14.50  
      FTB               LA               MARG             MAT       
 Min.   :0.0000   Min.   : 0.0000   Min.   :-0.900   Min.   :0.420  
 1st Qu.:0.0000   1st Qu.: 0.6675   1st Qu.: 1.500   1st Qu.:0.930  
 Median :1.0000   Median : 1.3550   Median : 2.400   Median :1.000  
 Mean   :0.6154   Mean   : 5.6827   Mean   : 2.292   Mean   :1.058  
 3rd Qu.:1.0000   3rd Qu.: 8.9100   3rd Qu.: 3.040   3rd Qu.:1.000  
 Max.   :1.0000   Max.   :93.4900   Max.   : 5.500   Max.   :2.380  
       MC              MOB               NW               PTS       
 Min.   :0.0000   Min.   : 1.000   Min.   :-0.0560   Min.   :0.000  
 1st Qu.:0.0000   1st Qu.: 1.000   1st Qu.: 0.3585   1st Qu.:1.000  
 Median :1.0000   Median : 2.000   Median : 0.7945   Median :1.660  
 Mean   :0.6026   Mean   : 4.205   Mean   : 3.5040   Mean   :1.498  
 3rd Qu.:1.0000   3rd Qu.: 4.000   3rd Qu.: 7.5575   3rd Qu.:2.022  
 Max.   :1.0000   Max.   :28.000   Max.   :17.8600   Max.   :4.340  
       SE              STL              Y               YLD       
 Min.   :0.0000   Min.   : 0.00   Min.   :0.0000   Min.   :1.380  
 1st Qu.:0.0000   1st Qu.: 3.69   1st Qu.:0.0000   1st Qu.:1.450  
 Median :0.0000   Median : 8.44   Median :0.0000   Median :1.590  
 Mean   :0.1026   Mean   :13.42   Mean   :0.4103   Mean   :1.606  
 3rd Qu.:0.0000   3rd Qu.:19.43   3rd Qu.:1.0000   3rd Qu.:1.640  
 Max.   :1.0000   Max.   :86.35   Max.   :1.0000   Max.   :2.040  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo logit</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>modelo_logit <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                      FI <span class="sc">+</span> MARG <span class="sc">+</span> YLD <span class="sc">+</span> PTS <span class="sc">+</span> MAT <span class="sc">+</span> BA <span class="sc">+</span> BS <span class="sc">+</span> FTB <span class="sc">+</span> CB <span class="sc">+</span> MC <span class="sc">+</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                      SE <span class="sc">+</span> MOB <span class="sc">+</span> NW <span class="sc">+</span> LA <span class="sc">+</span> STL, </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data=</span>PREST_HIP, <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"logit"</span>))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_logit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Y ~ FI + MARG + YLD + PTS + MAT + BA + BS + FTB + 
    CB + MC + SE + MOB + NW + LA + STL, family = binomial(link = "logit"), 
    data = PREST_HIP)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept) -4.23887   10.47904  -0.405   0.6858  
FI           1.71750    0.72773   2.360   0.0183 *
MARG        -1.18952    0.48545  -2.450   0.0143 *
YLD         -4.62670    2.91972  -1.585   0.1130  
PTS         -1.49980    0.71993  -2.083   0.0372 *
MAT         -2.05707    1.63112  -1.261   0.2073  
BA          -0.01048    0.07569  -0.138   0.8899  
BS          -0.19825    0.17245  -1.150   0.2503  
FTB          0.11092    0.98371   0.113   0.9102  
CB          -1.75974    1.24217  -1.417   0.1566  
MC          -1.92294    1.18297  -1.626   0.1041  
SE          -2.20851    2.80100  -0.788   0.4304  
MOB         -0.15308    0.09700  -1.578   0.1145  
NW           0.24406    0.18503   1.319   0.1872  
LA           0.02207    0.06101   0.362   0.7176  
STL          0.03156    0.05172   0.610   0.5417  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 105.604  on 77  degrees of freedom
Residual deviance:  61.792  on 62  degrees of freedom
AIC: 93.792

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo probit</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>modelo_probit <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> FI <span class="sc">+</span> MARG <span class="sc">+</span> YLD <span class="sc">+</span> PTS <span class="sc">+</span> MAT <span class="sc">+</span> BA <span class="sc">+</span> BS <span class="sc">+</span> FTB <span class="sc">+</span> CB <span class="sc">+</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                       MC <span class="sc">+</span> SE <span class="sc">+</span> MOB <span class="sc">+</span> NW <span class="sc">+</span> LA <span class="sc">+</span> STL, </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data=</span>PREST_HIP, <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"probit"</span>))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_probit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Y ~ FI + MARG + YLD + PTS + MAT + BA + BS + FTB + 
    CB + MC + SE + MOB + NW + LA + STL, family = binomial(link = "probit"), 
    data = PREST_HIP)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept) -3.107496   5.877216  -0.529   0.5970   
FI           1.008059   0.410667   2.455   0.0141 * 
MARG        -0.705235   0.272291  -2.590   0.0096 **
YLD         -2.525164   1.588075  -1.590   0.1118   
PTS         -0.830267   0.397719  -2.088   0.0368 * 
MAT         -1.164395   0.894643  -1.302   0.1931   
BA          -0.003978   0.042864  -0.093   0.9261   
BS          -0.108266   0.099792  -1.085   0.2780   
FTB          0.143454   0.558299   0.257   0.7972   
CB          -1.066544   0.692153  -1.541   0.1233   
MC          -1.058573   0.672743  -1.574   0.1156   
SE          -1.127484   1.559724  -0.723   0.4698   
MOB         -0.093035   0.054982  -1.692   0.0906 . 
NW           0.128775   0.105279   1.223   0.2213   
LA           0.014615   0.034992   0.418   0.6762   
STL          0.016129   0.028296   0.570   0.5687   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 105.604  on 77  degrees of freedom
Residual deviance:  61.459  on 62  degrees of freedom
AIC: 93.459

Number of Fisher Scoring iterations: 7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Significación de las características personales</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span> ( modelo_logit , <span class="fu">c</span>(<span class="st">"BA = 0"</span>, <span class="st">"BS = 0"</span>,<span class="st">"FTB = 0"</span>,<span class="st">"CB = 0"</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"MC = 0"</span>,<span class="st">"SE = 0"</span>,<span class="st">"MOB = 0"</span>,<span class="st">"NW = 0"</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"LA = 0"</span>,<span class="st">"STL = 0"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear hypothesis test

Hypothesis:
BA = 0
BS = 0
FTB = 0
CB = 0
MC = 0
SE = 0
MOB = 0
NW = 0
LA = 0
STL = 0

Model 1: restricted model
Model 2: Y ~ FI + MARG + YLD + PTS + MAT + BA + BS + FTB + CB + MC + SE + 
    MOB + NW + LA + STL

  Res.Df Df  Chisq Pr(&gt;Chisq)
1     72                     
2     62 10 12.728     0.2393</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelos logit restringidos</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>modelo_logit_1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> FI <span class="sc">+</span> MARG <span class="sc">+</span> YLD <span class="sc">+</span> PTS <span class="sc">+</span> MAT, <span class="at">data=</span>PREST_HIP, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"logit"</span>))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_logit_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Y ~ FI + MARG + YLD + PTS + MAT, family = binomial(link = "logit"), 
    data = PREST_HIP)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)  -6.7318     7.0594  -0.954  0.34029   
FI            1.2646     0.4540   2.785  0.00535 **
MARG         -0.7178     0.3138  -2.287  0.02218 * 
YLD          -4.8275     1.9588  -2.465  0.01372 * 
PTS          -0.3590     0.4234  -0.848  0.39641   
MAT          -0.5503     1.0366  -0.531  0.59549   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 105.604  on 77  degrees of freedom
Residual deviance:  82.946  on 72  degrees of freedom
AIC: 94.946

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span> ( modelo_logit_1, <span class="fu">c</span>(<span class="st">"PTS = 0"</span>, <span class="st">"MAT = 0"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear hypothesis test

Hypothesis:
PTS = 0
MAT = 0

Model 1: restricted model
Model 2: Y ~ FI + MARG + YLD + PTS + MAT

  Res.Df Df Chisq Pr(&gt;Chisq)
1     74                    
2     72  2 0.959     0.6191</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>modelo_logit_2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> FI <span class="sc">+</span> MARG <span class="sc">+</span> YLD, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data=</span>PREST_HIP, <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"logit"</span>))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_logit_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Y ~ FI + MARG + YLD, family = binomial(link = "logit"), 
    data = PREST_HIP)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)  -8.1920     6.8807  -1.191  0.23382   
FI            1.1846     0.4387   2.700  0.00693 **
MARG         -0.6608     0.2852  -2.317  0.02049 * 
YLD          -4.0305     1.7131  -2.353  0.01864 * 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 105.604  on 77  degrees of freedom
Residual deviance:  83.959  on 74  degrees of freedom
AIC: 91.959

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de convarianzas robusta</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(modelo_logit_2, <span class="at">vcov. =</span> vcovHC, <span class="at">type =</span> <span class="st">"HC1"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
z test of coefficients:

            Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept) -8.19199    8.03329 -1.0198  0.30784  
FI           1.18465    0.57315  2.0669  0.03874 *
MARG        -0.66076    0.30026 -2.2006  0.02776 *
YLD         -4.03050    1.83833 -2.1925  0.02834 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuste del modelo: pseudoR2</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>pseudoR2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (modelo_logit_2<span class="sc">$</span>deviance) <span class="sc">/</span> (modelo_logit_2<span class="sc">$</span>null.deviance)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>pseudoR2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2049648</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fórmula equivalente</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>modelo_logit_0 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data=</span>PREST_HIP, <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"logit"</span>))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">logLik</span>(modelo_logit_2)[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">logLik</span>(modelo_logit_0)[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2049648</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(modelo_logit_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II tests)

Response: Y
     LR Chisq Df Pr(&gt;Chisq)   
FI     8.3553  1   0.003846 **
MARG   6.2076  1   0.012720 * 
YLD    6.1767  1   0.012945 * 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla de éxito-fracaso (confusion matrix)</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="at">true=</span>PREST_HIP<span class="sc">$</span>Y, <span class="at">predicted=</span><span class="fu">round</span>(<span class="fu">fitted</span>(modelo_logit_2)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    predicted
true  0  1
   0 37  9
   1 11 21</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráficas de efectos marginales</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica conjunta</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>effs <span class="ot">&lt;-</span> <span class="fu">Effect</span>(<span class="fu">c</span>(<span class="st">"FI"</span>, <span class="st">"MARG"</span>,<span class="st">"YLD"</span>), modelo_logit_2)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(effs, <span class="at">multiline=</span><span class="cn">TRUE</span>, <span class="at">grid=</span><span class="cn">TRUE</span>, <span class="at">lines=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"FI"</span>,<span class="at">main=</span><span class="st">""</span>, <span class="at">rotx=</span><span class="dv">45</span>, <span class="at">roty =</span> <span class="dv">45</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Prob[Y=1]"</span>, <span class="at">rescale.axis=</span><span class="cn">FALSE</span>, <span class="at">rug=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="p3c2-app12_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráficas separadas</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Función de probabilidad estimada para la variable FI</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( Y <span class="sc">~</span> FI, PREST_HIP, <span class="at">xlab=</span><span class="st">"FI"</span>, <span class="at">ylab=</span><span class="st">"Prob"</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>FInew <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="at">length=</span><span class="dv">78</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(FInew, <span class="fu">predict</span>(modelo_logit_2, </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">FI=</span>FInew, </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">MARG=</span><span class="fu">rep</span>(<span class="fu">mean</span>(PREST_HIP<span class="sc">$</span>MARG), <span class="dv">78</span>), </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">YLD=</span><span class="fu">rep</span>(<span class="fu">mean</span>(PREST_HIP<span class="sc">$</span>YLD), <span class="dv">78</span>)),</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">type=</span><span class="st">"response"</span>), <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>(<span class="at">col=</span><span class="st">"gray"</span>, <span class="at">lty=</span><span class="st">"solid"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="p3c2-app12_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Función de probabilidad estimada para la variable MARG</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( Y <span class="sc">~</span> MARG, PREST_HIP, <span class="at">xlab=</span><span class="st">"MARG"</span>, <span class="at">ylab=</span><span class="st">"Prob"</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>MARGnew <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">6</span>, <span class="at">length=</span><span class="dv">78</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(MARGnew, <span class="fu">predict</span>(modelo_logit_2, </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">FI=</span><span class="fu">rep</span>(<span class="fu">mean</span>(PREST_HIP<span class="sc">$</span>FI), <span class="dv">78</span>), </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">MARG=</span>MARGnew, </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">YLD=</span><span class="fu">rep</span>(<span class="fu">mean</span>(PREST_HIP<span class="sc">$</span>YLD), <span class="dv">78</span>)),</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">type=</span><span class="st">"response"</span>), <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>(<span class="at">col=</span><span class="st">"gray"</span>, <span class="at">lty=</span><span class="st">"solid"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="p3c2-app12_files/figure-html/unnamed-chunk-2-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Función de probabilidad estimada para la variable YLD</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( Y <span class="sc">~</span> YLD, PREST_HIP, <span class="at">xlab=</span><span class="st">"YLD"</span>, <span class="at">ylab=</span><span class="st">"Prob"</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>YLDnew <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fl">2.5</span>, <span class="at">length=</span><span class="dv">78</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(YLDnew, <span class="fu">predict</span>(modelo_logit_2, </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">FI=</span><span class="fu">rep</span>(<span class="fu">mean</span>(PREST_HIP<span class="sc">$</span>FI), <span class="dv">78</span>), </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">MARG=</span><span class="fu">rep</span>(<span class="fu">mean</span>(PREST_HIP<span class="sc">$</span>MARG), <span class="dv">78</span>), </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">YLD=</span>YLDnew), </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">type=</span><span class="st">"response"</span>), <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>(<span class="at">col=</span><span class="st">"gray"</span>, <span class="at">lty=</span><span class="st">"solid"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="p3c2-app12_files/figure-html/unnamed-chunk-2-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Efecto marginal en la media de las variables explicativas</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>EMM_logit <span class="ot">=</span> mfx<span class="sc">::</span><span class="fu">logitmfx</span>(<span class="at">formula =</span> modelo_logit_2<span class="sc">$</span>formula, </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> modelo_logit_2<span class="sc">$</span>data, <span class="at">atmean =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(EMM_logit[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          dF/dx  Std. Err.         z       P&gt;|z|
FI    0.2793924 0.10036058  2.783886 0.005371188
MARG -0.1558367 0.06775255 -2.300085 0.021443381
YLD  -0.9505699 0.40847037 -2.327145 0.019957534</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Efecto marginal promedio (EMP)</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>EMP_logit <span class="ot">=</span> mfx<span class="sc">::</span><span class="fu">logitmfx</span>(<span class="at">formula =</span> modelo_logit_2<span class="sc">$</span>formula, </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> modelo_logit_2<span class="sc">$</span>data, <span class="at">atmean =</span> <span class="cn">FALSE</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(EMP_logit[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          dF/dx  Std. Err.         z      P&gt;|z|
FI    0.2137508 0.09751929  2.191883 0.02838798
MARG -0.1192238 0.06044562 -1.972413 0.04856242
YLD  -0.7272391 0.36590870 -1.987488 0.04686835</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Forma alternativa del EMP</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">margins</span>(modelo_logit_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     FI    MARG     YLD
 0.2138 -0.1192 -0.7272</code></pre>
</div>
</div>
</section>
<section id="código-python" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="código-python">Código Python</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lectura de librerías</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Lectura de datos</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>PREST_HIP <span class="op">=</span> pd.read_csv(<span class="st">"data/PREST_HIP.csv"</span>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>PREST_HIP.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              BA         BS         CB  ...        STL          Y        YLD
count  78.000000  78.000000  78.000000  ...  78.000000  78.000000  78.000000
mean   36.038462  16.448718   0.358974  ...  13.422179   0.410256   1.606410
std     8.052494   3.730003   0.482805  ...  15.230270   0.495064   0.184616
min    24.000000   6.000000   0.000000  ...   0.000000   0.000000   1.380000
25%    31.000000  14.000000   0.000000  ...   3.690000   0.000000   1.450000
50%    36.500000  16.000000   0.000000  ...   8.440000   0.000000   1.590000
75%    40.500000  18.000000   1.000000  ...  19.435000   1.000000   1.640000
max    65.000000  25.000000   1.000000  ...  86.350000   1.000000   2.040000

[8 rows x 16 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo logit</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>modelo_logit <span class="op">=</span> smf.glm(<span class="st">"Y ~ 1 + FI + MARG + YLD"</span>, data <span class="op">=</span> PREST_HIP, </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>family <span class="op">=</span> sm.families.Binomial(link <span class="op">=</span> sm.genmod.families.links.logit())).fit()</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(modelo_logit.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 Generalized Linear Model Regression Results                  
==============================================================================
Dep. Variable:                      Y   No. Observations:                   78
Model:                            GLM   Df Residuals:                       74
Model Family:                Binomial   Df Model:                            3
Link Function:                  logit   Scale:                          1.0000
Method:                          IRLS   Log-Likelihood:                -41.980
Date:                Tue, 07 Nov 2023   Deviance:                       83.959
Time:                        07:09:14   Pearson chi2:                     91.9
No. Iterations:                     4   Pseudo R-squ. (CS):             0.2423
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     -8.1920      6.881     -1.191      0.234     -21.678       5.294
FI             1.1846      0.439      2.700      0.007       0.325       2.045
MARG          -0.6608      0.285     -2.317      0.020      -1.220      -0.102
YLD           -4.0305      1.713     -2.353      0.019      -7.388      -0.673
==============================================================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Formulación alternativa del modelo logit</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>modelo_logit <span class="op">=</span> smf.logit(<span class="st">"Y ~ 1 + FI + MARG + YLD"</span>, data <span class="op">=</span> PREST_HIP).fit()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.538200
         Iterations 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(modelo_logit.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           Logit Regression Results                           
==============================================================================
Dep. Variable:                      Y   No. Observations:                   78
Model:                          Logit   Df Residuals:                       74
Method:                           MLE   Df Model:                            3
Date:                Tue, 07 Nov 2023   Pseudo R-squ.:                  0.2050
Time:                        07:09:14   Log-Likelihood:                -41.980
converged:                       True   LL-Null:                       -52.802
Covariance Type:            nonrobust   LLR p-value:                 7.731e-05
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     -8.1920      6.881     -1.191      0.234     -21.678       5.294
FI             1.1846      0.439      2.700      0.007       0.325       2.045
MARG          -0.6608      0.285     -2.317      0.020      -1.220      -0.102
YLD           -4.0305      1.713     -2.353      0.019      -7.388      -0.673
==============================================================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo probit</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>modelo_probit <span class="op">=</span> smf.probit(<span class="st">"Y ~ 1 + FI + MARG + YLD"</span>, data <span class="op">=</span> PREST_HIP).fit()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.542249
         Iterations 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(modelo_probit.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          Probit Regression Results                           
==============================================================================
Dep. Variable:                      Y   No. Observations:                   78
Model:                         Probit   Df Residuals:                       74
Method:                           MLE   Df Model:                            3
Date:                Tue, 07 Nov 2023   Pseudo R-squ.:                  0.1990
Time:                        07:09:14   Log-Likelihood:                -42.295
converged:                       True   LL-Null:                       -52.802
Covariance Type:            nonrobust   LLR p-value:                 0.0001046
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     -4.2090      3.914     -1.075      0.282     -11.881       3.463
FI             0.6453      0.236      2.740      0.006       0.184       1.107
MARG          -0.4080      0.163     -2.504      0.012      -0.727      -0.089
YLD           -2.2888      0.988     -2.318      0.020      -4.224      -0.353
==============================================================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabla de éxito-fracaso</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>tmp_out_1 <span class="op">=</span> modelo_logit.pred_table(threshold <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pd.DataFrame(tmp_out_1, </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>                   columns <span class="op">=</span> [<span class="st">"Predichos 0"</span>, <span class="st">"Predichos 1"</span>],</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>                   index <span class="op">=</span> [<span class="st">"Observados 0"</span>, <span class="st">"Observados 1"</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Predichos 0  Predichos 1
Observados 0         37.0          9.0
Observados 1         11.0         21.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Formulación alternativa</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> metrics</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>predicted_probs_logit <span class="op">=</span> modelo_logit.predict(exog <span class="op">=</span> PREST_HIP)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>tmp_out_2 <span class="op">=</span> metrics.confusion_matrix(modelo_logit.model.endog, </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>                                   np.where(predicted_probs_logit <span class="op">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pd.DataFrame(tmp_out_2, </span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>                   columns <span class="op">=</span> [<span class="st">"Predichos 0"</span>, <span class="st">"Predichos 1"</span>],</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>                   index <span class="op">=</span> [<span class="st">"Observados 0"</span>, <span class="st">"Observados 1"</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Predichos 0  Predichos 1
Observados 0           37            9
Observados 1           11           21</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Precisión global del modelo en términos de predicción</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>tmp_accuracy <span class="op">=</span> metrics.accuracy_score(modelo_logit.model.endog,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                       np.where(predicted_probs_logit <span class="op">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.<span class="bu">round</span>(tmp_accuracy,<span class="dv">4</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.7436</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Efecto marginal en la media de las variables explicativas</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>EMM_logit <span class="op">=</span> modelo_logit.get_margeff(at <span class="op">=</span> <span class="st">"mean"</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(EMM_logit.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Logit Marginal Effects       
=====================================
Dep. Variable:                      Y
Method:                          dydx
At:                              mean
==============================================================================
                dy/dx    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
FI             0.2794      0.100      2.784      0.005       0.083       0.476
MARG          -0.1558      0.068     -2.300      0.021      -0.289      -0.023
YLD           -0.9506      0.408     -2.327      0.020      -1.751      -0.150
==============================================================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Efecto marginal promedio</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>EMP_logit <span class="op">=</span> modelo_logit.get_margeff(at <span class="op">=</span> <span class="st">"overall"</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(EMP_logit.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Logit Marginal Effects       
=====================================
Dep. Variable:                      Y
Method:                          dydx
At:                           overall
==============================================================================
                dy/dx    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
FI             0.2138      0.065      3.274      0.001       0.086       0.342
MARG          -0.1192      0.045     -2.648      0.008      -0.207      -0.031
YLD           -0.7272      0.268     -2.719      0.007      -1.252      -0.203
==============================================================================</code></pre>
</div>
</div>
</section>
<section id="variable-dependiente-limitada-valores-censurados---modelo-tobit-compra-de-automóviles" class="level2 unnumbered justify">
<h2 class="unnumbered anchored" data-anchor-id="variable-dependiente-limitada-valores-censurados---modelo-tobit-compra-de-automóviles">Variable dependiente limitada (valores censurados -&gt; modelo Tobit): Compra de automóviles</h2>
<p>En un trabajo encargado por una asociación de fabricantes de automóviles, se estimó un modelo microeconométrico en el que se relacionaba el gasto en automóviles realizado por las familias que componían una muestra representativa con algunas características socioeconómicas de las mismas.</p>
<p>La ecuación de comportamiento especificada fue la siguiente:</p>
<p><span class="math display">\[GAUT_{i} = \beta_1 + \beta_2 Y_{i} + \beta_3 HIJOSM18_{i} + \beta_4 EDAD_{i} + e_{i}\]</span></p>
<p>donde <span class="math inline">\(GAUT\)</span> es el gasto familiar efectuado en la adquisición de automóviles en el último año, <span class="math inline">\(Y\)</span> es la renta familiar total del último ejercicio fiscal, <span class="math inline">\(HIJOSM18\)</span> es el número de hijos con edades inferiores a dieciocho años, y <span class="math inline">\(EDAD\)</span> es la edad del cabeza de familia.</p>
</section>
<section id="código-r-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="código-r-1">Código R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lectura de librerías</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(censReg) <span class="co"># http://www.sampleselection.org/</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Lectura de datos</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>AUTOS <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/AUTOS.csv"</span>)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(AUTOS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      EDAD            GAUT         HIJOSM18           Y        
 Min.   :30.00   Min.   :   0   Min.   :0.000   Min.   :  750  
 1st Qu.:38.00   1st Qu.:   0   1st Qu.:0.000   1st Qu.: 7714  
 Median :46.00   Median :   0   Median :1.000   Median :10440  
 Mean   :45.12   Mean   :1850   Mean   :1.591   Mean   :11540  
 3rd Qu.:52.00   3rd Qu.:3580   3rd Qu.:3.000   3rd Qu.:14100  
 Max.   :60.00   Max.   :9980   Max.   :8.000   Max.   :48000  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos censurados: modelo Tobit </span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Librería censReg </span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co"># (https://cran.r-project.org/web/packages/censReg/vignettes/censReg.pdf)</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>modelo_tobit_1 <span class="ot">&lt;-</span> <span class="fu">censReg</span>(GAUT <span class="sc">~</span> EDAD <span class="sc">+</span> HIJOSM18 <span class="sc">+</span> Y, <span class="at">data =</span> AUTOS)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_tobit_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
censReg(formula = GAUT ~ EDAD + HIJOSM18 + Y, data = AUTOS)

Observations:
         Total  Left-censored     Uncensored Right-censored 
           753            417            336              0 

Coefficients:
              Estimate Std. error t value Pr(&gt; t)    
(Intercept) 3337.95574 1683.38404   1.983  0.0474 *  
EDAD         -44.11124   32.48820  -1.358  0.1745    
HIJOSM18    -289.11846  182.60176  -1.583  0.1133    
Y             -0.60588    0.02136 -28.365  &lt;2e-16 ***
logSigma       8.54026        NaN     NaN     NaN    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Newton-Raphson maximisation, 5 iterations
Return code 3: Last step could not find a value above the current.
Boundary of parameter space?  
Consider switching to a more robust optimisation method temporarily.
Log-likelihood: -4107.679 on 5 Df</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Efectos marginales</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluados en un valor concreto de las var. explicativas </span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="co"># (media de las variables en este caso)</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">margEff</span>(modelo_tobit_1, </span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">xValues =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fu">mean</span>(AUTOS<span class="sc">$</span>EDAD),<span class="fu">mean</span>(AUTOS<span class="sc">$</span>HIJOSM18),<span class="fu">mean</span>(AUTOS<span class="sc">$</span>Y)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        EDAD     HIJOSM18            Y 
 -5.13563279 -33.66049621  -0.07053975 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Efectos marginales promedio</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">margEff</span>(modelo_tobit_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        EDAD     HIJOSM18            Y 
 -5.13563279 -33.66049621  -0.07053975 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Librería VGAM (https://www.stat.auckland.ac.nz/~yee/VGAM/)</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VGAM)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>modelo_tobit_2 <span class="ot">&lt;-</span> <span class="fu">vglm</span>(GAUT <span class="sc">~</span> EDAD <span class="sc">+</span> HIJOSM18 <span class="sc">+</span> Y, <span class="at">family =</span> tobit, </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> AUTOS)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_tobit_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
vglm(formula = GAUT ~ EDAD + HIJOSM18 + Y, family = tobit, data = AUTOS)

Coefficients: 
                Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept):1 3329.58619 1327.87243   2.507 0.012160 *  
(Intercept):2    8.40621    0.04143 202.910  &lt; 2e-16 ***
EDAD           -94.42435   25.90272  -3.645 0.000267 ***
HIJOSM18      -576.00676  148.16899  -3.887 0.000101 ***
Y                0.14027    0.02907   4.825  1.4e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Names of linear predictors: mu, loglink(sd)

Log-likelihood: -3575.642 on 1501 degrees of freedom

Number of Fisher scoring iterations: 7 

No Hauck-Donner effect found in any of the estimates</code></pre>
</div>
</div>
</section>
<section id="código-python-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="código-python-1">Código Python</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">py_run_file</span>(<span class="st">"tobit.py"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lectura de datos</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>AUTOS <span class="op">=</span> pd.read_csv(<span class="st">"data/AUTOS.csv"</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>AUTOS.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             EDAD         GAUT    HIJOSM18             Y
count  753.000000   753.000000  753.000000    753.000000
mean    45.120850  1849.734396    1.590969  11540.297477
std      8.058793  2419.886566    1.460481   6095.101013
min     30.000000     0.000000    0.000000    750.000000
25%     38.000000     0.000000    0.000000   7714.000000
50%     46.000000     0.000000    1.000000  10440.000000
75%     52.000000  3580.000000    3.000000  14100.000000
max     60.000000  9980.000000    8.000000  48000.000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimación del modelo Tobit con los datos de la aplicación</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> AUTOS.GAUT</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> AUTOS.drop([<span class="st">'GAUT'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>cens <span class="op">=</span> pd.Series(np.zeros((<span class="bu">len</span>(y),)))</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>cens[y<span class="op">==</span><span class="dv">0</span>] <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>cens.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-1.0    417
 0.0    336
dtype: int64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>modelo_tobit <span class="op">=</span> TobitModel()</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> modelo_tobit.fit(x, y, cens, verbose<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>res.coef_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([-9.44230300e+01, -5.76005085e+02,  1.40273997e-01])</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>res.sigma_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4474.697756597855</code></pre>
</div>
</div>
</section>
<section id="variable-dependiente-limitada-truncamiento-selectivo---modelo-heckit-de-selección-muestral-salarios-de-las-mujeres-casadas" class="level2 unnumbered justify">
<h2 class="unnumbered anchored" data-anchor-id="variable-dependiente-limitada-truncamiento-selectivo---modelo-heckit-de-selección-muestral-salarios-de-las-mujeres-casadas">Variable dependiente limitada (truncamiento selectivo -&gt; modelo Heckit de selección muestral): Salarios de las mujeres casadas</h2>
<p>En esta aplicación se estima una ecuación Minceriana de salarios para las mujeres casadas basada en una investigación de Thomas A. Mroz del año 1987 para el Reino Uniod. El modelo propuesto es el siguiente:</p>
<p><span class="math display">\[log(SALARIO_{i}) = \beta_1 + \beta_2 EDUC_{i} + \beta_3 EXPER_{i} + e_{i}\]</span></p>
<p>donde <span class="math inline">\(SALARIO\)</span> representa el salario por hora trabajada observado, <span class="math inline">\(EDUC\)</span> es el nivel de educación y <span class="math inline">\(EXPER\)</span> es el nivel de experiencia.</p>
<p>Al realizar una encuesta a una muestra de N = 753 mujeres casadas, representativa de la población femenina con ese estado civil en UK, preguntándoles entre otras cosas por su salario, muchas de ellas (325 mujeres) respondieron que esa cuestión no era relevante en su caso, ya que eran “amas de casa” (población no activa) y no recibían remuneración alguna por ese trabajo. Solo se observaron datos sobre salarios de mercado para aquellas mujeres (n = 428) que participaban en la fuerza de trabajo.</p>
</section>
<section id="código-r-2" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="código-r-2">Código R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lectura de librerías</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sampleSelection) <span class="co"># http://www.sampleselection.org/</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Lectura de datos</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>SAL_MUJ <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/SAL_MUJ.csv"</span>)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SAL_MUJ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      EDAD         EDADMARIDO         EDUC         EDUCMADRE     
 Min.   :30.00   Min.   :30.00   Min.   : 5.00   Min.   : 0.000  
 1st Qu.:36.00   1st Qu.:38.00   1st Qu.:12.00   1st Qu.: 7.000  
 Median :43.00   Median :46.00   Median :12.00   Median :10.000  
 Mean   :42.54   Mean   :45.12   Mean   :12.29   Mean   : 9.251  
 3rd Qu.:49.00   3rd Qu.:52.00   3rd Qu.:13.00   3rd Qu.:12.000  
 Max.   :60.00   Max.   :60.00   Max.   :17.00   Max.   :17.000  
                                                                 
 EDUCMADREMARIDO    EDUCMARIDO      EDUCPADRE      EDUCPADREMARIDO 
 Min.   : 0.000   Min.   : 3.00   Min.   : 0.000   Min.   : 0.000  
 1st Qu.: 7.000   1st Qu.:11.00   1st Qu.: 7.000   1st Qu.: 7.000  
 Median : 9.000   Median :12.00   Median : 7.000   Median : 7.000  
 Mean   : 9.242   Mean   :12.49   Mean   : 8.809   Mean   : 8.525  
 3rd Qu.:12.000   3rd Qu.:15.00   3rd Qu.:12.000   3rd Qu.:10.000  
 Max.   :17.000   Max.   :17.00   Max.   :17.000   Max.   :17.000  
                                                                   
     EXPER          HIJOS618        HIJOSM18        HIJOSM6      
 Min.   : 0.00   Min.   :0.000   Min.   :0.000   Min.   :0.0000  
 1st Qu.: 4.00   1st Qu.:0.000   1st Qu.:0.000   1st Qu.:0.0000  
 Median : 9.00   Median :1.000   Median :1.000   Median :0.0000  
 Mean   :10.63   Mean   :1.353   Mean   :1.591   Mean   :0.2377  
 3rd Qu.:15.00   3rd Qu.:2.000   3rd Qu.:3.000   3rd Qu.:0.0000  
 Max.   :45.00   Max.   :8.000   Max.   :8.000   Max.   :3.0000  
                                                                 
    HIJOSMEN        HORASTRAB      HORASTRABMARIDO     IMPFED     
 Min.   :0.0000   Min.   :   0.0   Min.   : 175    Min.   :    0  
 1st Qu.:0.0000   1st Qu.:   0.0   1st Qu.:1928    1st Qu.: 1428  
 Median :1.0000   Median : 288.0   Median :2164    Median : 2426  
 Mean   :0.6959   Mean   : 740.6   Mean   :2267    Mean   : 3276  
 3rd Qu.:1.0000   3rd Qu.:1516.0   3rd Qu.:2553    3rd Qu.: 3947  
 Max.   :1.0000   Max.   :4950.0   Max.   :5010    Max.   :31386  
                                                                  
      PMT            SALARIO        SALARIOMARIDO         TMIMP       
 Min.   :0.0000   Min.   : 0.1282   Min.   : 0.4121   Min.   :0.4415  
 1st Qu.:0.0000   1st Qu.: 2.2626   1st Qu.: 4.7883   1st Qu.:0.6215  
 Median :1.0000   Median : 3.4819   Median : 6.9758   Median :0.6915  
 Mean   :0.5684   Mean   : 4.1777   Mean   : 7.4822   Mean   :0.6789  
 3rd Qu.:1.0000   3rd Qu.: 4.9708   3rd Qu.: 9.1667   3rd Qu.:0.7215  
 Max.   :1.0000   Max.   :25.0000   Max.   :40.5090   Max.   :0.9415  
                  NA's   :325                                         
      YFAM      
 Min.   : 1500  
 1st Qu.:15428  
 Median :20880  
 Mean   :23081  
 3rd Qu.:28200  
 Max.   :96000  
                </code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo Heckit (https://cran.r-project.org/web/packages/sampleSelection/vignettes/selection.pdf)</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>modelo_heckit <span class="ot">&lt;-</span> <span class="fu">selection</span>(PMT <span class="sc">~</span> EDUC <span class="sc">+</span> EDAD <span class="sc">+</span> HIJOSMEN <span class="sc">+</span> TMIMP, </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">log</span>(SALARIO) <span class="sc">~</span> EDUC <span class="sc">+</span> EXPER, </span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data=</span>SAL_MUJ, <span class="at">method=</span><span class="st">"ml"</span>)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_heckit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--------------------------------------------
Tobit 2 model (sample selection model)
Maximum Likelihood estimation
Newton-Raphson maximisation, 6 iterations
Return code 8: successive function values within relative tolerance limit (reltol)
Log-Likelihood: -913.561 
753 observations (325 censored and 428 observed)
10 free parameters (df = 743)
Probit selection equation:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.595958   0.623731   2.559  0.01070 *  
EDUC         0.063931   0.021745   2.940  0.00338 ** 
EDAD        -0.013262   0.005939  -2.233  0.02584 *  
HIJOSMEN    -0.152592   0.099587  -1.532  0.12589    
TMIMP       -2.291885   0.537565  -4.263 2.27e-05 ***
Outcome equation:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 0.668587   0.235006   2.845  0.00456 ** 
EDUC        0.065816   0.016635   3.957 8.33e-05 ***
EXPER       0.011767   0.004094   2.875  0.00416 ** 
   Error terms:
      Estimate Std. Error t value Pr(&gt;|t|)    
sigma  0.84944    0.04248   20.00   &lt;2e-16 ***
rho   -0.83947    0.03490  -24.05   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
--------------------------------------------</code></pre>
</div>
</div>
</section>
<section id="código-python-2" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="código-python-2">Código Python</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lectura de librerías</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Lectura de datos</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>SAL_MUJ <span class="op">=</span> pd.read_csv(<span class="st">"data/SAL_MUJ.csv"</span>)</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>SAL_MUJ.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             EDAD  EDADMARIDO  ...       TMIMP          YFAM
count  753.000000  753.000000  ...  753.000000    753.000000
mean    42.537849   45.120850  ...    0.678863  23080.594954
std      8.072574    8.058793  ...    0.083496  12190.202026
min     30.000000   30.000000  ...    0.441500   1500.000000
25%     36.000000   38.000000  ...    0.621500  15428.000000
50%     43.000000   46.000000  ...    0.691500  20880.000000
75%     49.000000   52.000000  ...    0.721500  28200.000000
max     60.000000   60.000000  ...    0.941500  96000.000000

[8 rows x 21 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo Heckit</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimación en dos pasos (menos eficiente que la estimación ML)</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Realizando las regresiones "manualmente"</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Paso 1 (modelo Probit para todas las observaciones)</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>reg_probit <span class="op">=</span> smf.probit(formula<span class="op">=</span><span class="st">'PMT ~ EDUC + EDAD + HIJOSMEN + TMIMP'</span>, data<span class="op">=</span>SAL_MUJ)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>res_probit <span class="op">=</span> reg_probit.fit(disp<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(res_probit.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          Probit Regression Results                           
==============================================================================
Dep. Variable:                    PMT   No. Observations:                  753
Model:                         Probit   Df Residuals:                      748
Method:                           MLE   Df Model:                            4
Date:                Tue, 07 Nov 2023   Pseudo R-squ.:                 0.04026
Time:                        07:09:19   Log-Likelihood:                -494.15
converged:                       True   LL-Null:                       -514.87
Covariance Type:            nonrobust   LLR p-value:                 2.164e-08
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      1.1923      0.721      1.655      0.098      -0.220       2.605
EDUC           0.0838      0.023      3.610      0.000       0.038       0.129
EDAD          -0.0206      0.007     -2.926      0.003      -0.034      -0.007
HIJOSMEN      -0.3139      0.124     -2.537      0.011      -0.556      -0.071
TMIMP         -1.3939      0.617     -2.261      0.024      -2.602      -0.185
==============================================================================</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>pred_PMT <span class="op">=</span> res_probit.fittedvalues</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>SAL_MUJ[<span class="st">'inv_mills'</span>] <span class="op">=</span> stats.norm.pdf(pred_PMT) <span class="op">/</span> stats.norm.cdf(pred_PMT)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Paso 2 (regresión truncada con las observaciones seleccionadas y la inversa de la razón de Mills como variable explicativa adicional)</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>reg_heckit <span class="op">=</span> smf.ols(formula<span class="op">=</span><span class="st">'np.log(SALARIO) ~ EDUC + EXPER + inv_mills'</span>, subset<span class="op">=</span>(SAL_MUJ[<span class="st">'PMT'</span>] <span class="op">==</span> <span class="dv">1</span>), data<span class="op">=</span>SAL_MUJ).fit(cov_type<span class="op">=</span><span class="st">'HAC'</span>, cov_kwds<span class="op">=</span>{<span class="st">'maxlags'</span>:<span class="dv">6</span>,<span class="st">'use_correction'</span>:<span class="va">True</span>})</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reg_heckit.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            OLS Regression Results                            
==============================================================================
Dep. Variable:        np.log(SALARIO)   R-squared:                       0.162
Model:                            OLS   Adj. R-squared:                  0.156
Method:                 Least Squares   F-statistic:                     30.13
Date:                Tue, 07 Nov 2023   Prob (F-statistic):           1.13e-17
Time:                        07:09:19   Log-Likelihood:                -430.22
No. Observations:                 428   AIC:                             868.4
Df Residuals:                     424   BIC:                             884.7
Df Model:                           3                                         
Covariance Type:                  HAC                                         
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      0.8105      0.468      1.734      0.083      -0.106       1.727
EDUC           0.0585      0.023      2.570      0.010       0.014       0.103
EXPER          0.0163      0.004      4.221      0.000       0.009       0.024
inv_mills     -0.8664      0.298     -2.903      0.004      -1.451      -0.281
==============================================================================
Omnibus:                       78.529   Durbin-Watson:                   2.007
Prob(Omnibus):                  0.000   Jarque-Bera (JB):              299.580
Skew:                          -0.766   Prob(JB):                     8.85e-66
Kurtosis:                       6.802   Cond. No.                         350.
==============================================================================

Notes:
[1] Standard Errors are heteroscedasticity and autocorrelation robust (HAC) using 6 lags and with small sample correction</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Usando el script heckman.py (statsmodels): errores estándar correctos</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>SAL_MUJ[<span class="st">'lSALARIO'</span>] <span class="op">=</span> np.log(SAL_MUJ[<span class="st">'SALARIO'</span>])</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>lSALARIO <span class="op">=</span> SAL_MUJ[<span class="st">'lSALARIO'</span>].copy() <span class="co"># Variable dependiente regresión truncada</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>Xs <span class="op">=</span> SAL_MUJ[[<span class="st">'EDUC'</span>, <span class="st">'EXPER'</span>]] <span class="co"># Variables exógenas regresión truncada</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(Xs, prepend <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>Ws <span class="op">=</span> SAL_MUJ[[<span class="st">'EDUC'</span>, <span class="st">'EDAD'</span>, <span class="st">'HIJOSMEN'</span>, <span class="st">'TMIMP'</span>]] <span class="co"># Variables exógenas ecuación selección</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>W <span class="op">=</span> sm.add_constant(Ws, prepend <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> heckman <span class="im">as</span> heckman </span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> heckman.Heckman(lSALARIO, X, W).fit(method<span class="op">=</span><span class="st">'twostep'</span>)</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(res.summary()) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Heckman Regression Results      
=======================================
Dep. Variable:                 lSALARIO
Model:                          Heckman
Method:                Heckman Two-Step
Date:                  Tue, 07 Nov 2023
Time:                          07:09:19
No. Total Obs.:                     753
No. Censored Obs.:                  325
No. Uncensored Obs.:                428
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
const          0.8105      0.611      1.327      0.185      -0.387       2.008
EDUC           0.0585      0.030      1.973      0.049       0.000       0.117
EXPER          0.0163      0.004      3.884      0.000       0.008       0.025
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
const          1.1923      0.721      1.655      0.098      -0.220       2.605
EDUC           0.0838      0.023      3.610      0.000       0.038       0.129
EDAD          -0.0206      0.007     -2.926      0.003      -0.034      -0.007
HIJOSMEN      -0.3139      0.124     -2.537      0.011      -0.556      -0.071
TMIMP         -1.3939      0.617     -2.261      0.024      -2.602      -0.185
================================================================================
                   coef    std err          z      P&gt;|z|      [0.025      0.975]
--------------------------------------------------------------------------------
IMR (Lambda)    -0.8664      0.399     -2.170      0.030      -1.649      -0.084
=====================================
rho:                           -0.929
sigma:                          0.933
=====================================

First table are the estimates for the regression (response) equation.
Second table are the estimates for the selection equation.
Third table is the estimate for the coef of the inverse Mills ratio (Heckman's Lambda).</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./p3c2-app11.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Aplicación 3.11 (Regresores endógenos - El estimador de variables instrumentales: Determinantes de la inflación al nivel internacional</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./p3c2-app13.html" class="pagination-link">
        <span class="nav-page-text">Aplicación 3.13 (Modelos econométricos para datos de panel): Productividad de la industria química en China</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>