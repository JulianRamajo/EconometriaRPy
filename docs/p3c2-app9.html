<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Econometría - Aplicación 3.9 (Información muestral - Falta de observaciones): Exclusión social en el comportamiento de las aseguradoras de Chicago</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./p3c2-app10.html" rel="next">
<link href="./p3c2-app8b.html" rel="prev">
<link href="./EconMetricsRPy-logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p3-mrl-extendido.html">CAPÍTULO 3: DIAGNOSIS, CORRECCIONES Y EXTENSIONES DEL MODELO DE REGRESIÓN LINEAL</a></li><li class="breadcrumb-item"><a href="./p3c2-app9.html">Aplicación 3.9 (Información muestral - Falta de observaciones): Exclusión social en el comportamiento de las aseguradoras de Chicago</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Econometría</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/JulianRamajo/EconometriaRPy" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PREFACIO</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p0-aspectos-tecnicos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CAPÍTULO 0: ASPECTOS TÉCNICOS</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p0c1-setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instalación y configuración de R y Python en RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p0c2-rpy-comp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R versus Python: Comparación de lenguajes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p0c3-reticulate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programación conjunta en R y Python con reticulate</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p1-introduccion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CAPÍTULO 1: CONCEPTOS BÁSICOS</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1c1-teoria.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Conceptos básicos de la econometría</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1c2-app1a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 1.1.a (Gestión y representación gráfica de datos): Gramática básica del <em>tidyverse</em></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1c2-app1b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 1.1.b (Gestión y representación gráfica de datos): Gestión de datos con R y Python</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1c2-app2a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 1.2a (Gestión y representación gráfica de datos financieros): Propiedades estadísticas básicas de los activos bursátiles</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1c2-app2b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 1.2b (Gestión y representación gráfica de datos financieros): Relaciones entre activos bursátiles</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1c2-app3a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 1.3.a (Gestión y representación gráfica de datos espaciales): Emisiones de CO2 al nivel mundial</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1c2-app3b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 1.3b (Gestión y representación gráfica de datos espaciales): Desarrollo humano al nivel mundial</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1c2-app4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 1.4 (Regresiones con datos de corte transversal): Demanda familiar de carne</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p1c2-app5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 1.5 (Regresiones con datos de series temporales): Consumo privado en Estados Unidos</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p2-mrl-basico.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CAPÍTULO 2: EL MODELO DE REGRESIÓN LINEAL Y SUS HIPÓTESIS BÁSICAS</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2c1-teoria.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">El modelo de regresión lineal y sus hipótesis básicas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2c2-app1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 2.1 (Estimación MCO y contrastes de hipótesis): Modelo CAPM para las acciones del Banco Santander</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2c2-app2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 2.2 (Predicción con el modelo de regresión lineal): Curva de Engel para el gasto en alimentos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2c2-app3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 2.3 (Modelo de regresión lineal con forma funcional polinómica): Curva de costes en el sector textil</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2c2-app4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 2.4 (Modelo de regresión lineal con términos de interacción): Efectos diferenciados de la publicidad sobre las ventas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2c2-app5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 2.5 (Modelo de regresión lineal con variables cualitativas): Brecha salarial entre hombres y mujeres en Estados Unidos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p2c2-app6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 2.6 (Series temporales de alta frecuencia y estacionalidad): Demanda de electricidad en el estado de Victoria, Australia</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p3-mrl-extendido.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CAPÍTULO 3: DIAGNOSIS, CORRECCIONES Y EXTENSIONES DEL MODELO DE REGRESIÓN LINEAL</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c1-teoria.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Diagnosis, correcciones y extensiones del modelo de regresión lineal</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c2-app1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 3.1 (Evaluación, validación y especificación del MRL): El modelo APT de valoración de activos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c2-app2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 3.2 (Evaluación, validación y especificación del MRL): Ventas en una cadena de supermercados</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c2-app3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 3.3 (Estabilidad de los parámetros estructurales): Diferenciación salarial por sexo. Exportaciones españolas.</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c2-app4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 3.4 (No normalidad de los errores y observaciones atípicas): Muestra de datos con observaciones atípicas simuladas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c2-app5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 3.5 (Regresiones heteroscedásticas): Función de demanda con varianza no constante</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c2-app6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 3.6 (Regresiones con volatilidad variable en el tiempo): Relación entre los precios de los carburantes y el precio del petroleo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c2-app7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 3.7 (Autocorrelación y regresiones dinámicas): Modelos ARDL y VAR</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c2-app8a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 3.8a (Dependencia espacial - Geometría: polígonos): Estadísticas ‘morales’ en Francia en 1830</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c2-app8b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 3.8b (Dependencia espacial - Geometría: puntos): Precio de la vivienda en el condado de Lucas [Ohio, Estados Unidos]</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c2-app9.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Aplicación 3.9 (Información muestral - Falta de observaciones): Exclusión social en el comportamiento de las aseguradoras de Chicago</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c2-app10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 3.10 (Información muestral - Multicolinealidad): Análisis de la rentabilidad empresarial</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c2-app11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 3.11 (Regresores endógenos - El estimador de variables instrumentales: Determinantes de la inflación al nivel internacional</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c2-app12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 3.12 (Variable dependiente discreta o limitada): Modelos Logit/Probit, Tobit y Heckit</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p3c2-app13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aplicación 3.13 (Modelos econométricos para datos de panel): Productividad de la industria química en China</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BIBLIOGRAFÍA</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#código-r" id="toc-código-r" class="nav-link active" data-scroll-target="#código-r">Código R</a></li>
  <li><a href="#código-python" id="toc-código-python" class="nav-link" data-scroll-target="#código-python">Código Python</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Aplicación 3.9 (Información muestral - Falta de observaciones): Exclusión social en el comportamiento de las aseguradoras de Chicago</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">
<style type="text/css">
.justify { text-align: justify !important }
</style>
</div>
<div class="justify">
<p>En esta aplicación se usarán los datos de un estudio de la década de 1970 sobre la relación entre la exclusión social de los seguros y la composición racial, los índices de incendio y robo, la antigüedad de las viviendas y los ingresos en 47 distritos postales de Chicago.</p>
</div>
<section id="código-r" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="código-r">Código R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lectura de librerías</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Lectura de datos</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># library(faraway)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># help(chredlin, package="faraway")</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>chmiss <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/SEGUROS_CHICAGO.csv"</span>, <span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">row.names=</span><span class="st">"zip"</span>) </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Versión tidyverse: read_csv("SEGUROS_CHICAGO.csv") %&gt;% </span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># column_to_rownames(., var = "zip")</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>chmiss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      race fire theft  age involact income
60626 10.0  6.2    29 60.4       NA 11.744
60640 22.2  9.5    44 76.5      0.1  9.323
60613 19.6 10.5    36   NA      1.2  9.948
60657 17.3  7.7    37   NA      0.5 10.656
60614 24.5  8.6    53 81.4      0.7  9.730
60610 54.0 34.1    68 52.6      0.3  8.231
60611  4.9 11.0    75 42.6      0.0 21.480
60625  7.1  6.9    18 78.5      0.0 11.104
60618  5.3  7.3    31 90.1       NA 10.694
60647 21.5 15.1    NA 89.8      1.1  9.631
60622 43.1 29.1    34 82.7      1.9  7.995
60631  1.1  2.2    14 40.2      0.0 13.722
60646   NA  5.7    11 27.9      0.0 16.250
60656  1.7  2.0    11  7.7      0.0 13.686
60630  1.6  2.5    22 63.8      0.0 12.405
60634  1.5  3.0    NA 51.2      0.0 12.198
60641  1.8  5.4    27 85.1      0.0 11.600
60635  1.0  2.2     9 44.4      0.0 12.765
60639  2.5  7.2    29 84.2      0.2 11.084
60651   NA 15.1    30 89.8      0.8 10.510
60644 59.8 16.5    40   NA      0.8  9.784
60624 94.4 18.4    32 72.9      1.8  7.342
60612 86.2 36.2    41 63.1      1.8  6.565
60607 50.2   NA   147 83.0      0.9  7.459
60623 74.2 18.5    22 78.3      1.9  8.014
60608 55.5   NA    29 79.0      1.5  8.177
60616   NA 12.2    46 48.0      0.6  8.212
60632  4.4  5.6    23 71.5      0.3 11.230
60609 46.2 21.8     4 73.1      1.3     NA
60653 99.7 21.6    31 65.0      0.9  5.583
60615 73.5  9.0    39 75.4      0.4  8.564
60638 10.7  3.6    15 20.8      0.0 12.102
60629  1.5  5.0    32 61.8       NA 11.876
60636 48.8 28.6    27 78.1      1.4  9.742
60621 98.9 17.4    NA 68.6      2.2  7.520
60637 90.6 11.3    34 73.4      0.8  7.388
60652  1.4  3.4    17  2.0      0.0 13.842
60620 71.2 11.9    46   NA      0.9 11.040
60619 94.1 10.5    42 55.9      0.9 10.332
60649 66.1 10.7    NA 67.5      0.4 10.908
60617   NA 10.8    34 58.0      0.9 11.156
60655  1.0  4.8    19 15.2      0.0 13.323
60643 42.5 10.4    25 40.8      0.5 12.960
60628 35.1 15.6    28 57.8      1.0     NA
60627 47.4  7.0     3 11.4      0.2 10.080
60633 34.0  7.1    23 49.2      0.3 11.428
60645  3.1  4.9    27   NA      0.0 13.731</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(chmiss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      race            fire           theft             age       
 Min.   : 1.00   Min.   : 2.00   Min.   :  3.00   Min.   : 2.00  
 1st Qu.: 3.75   1st Qu.: 5.60   1st Qu.: 22.00   1st Qu.:48.30  
 Median :24.50   Median : 9.50   Median : 29.00   Median :64.40  
 Mean   :35.61   Mean   :11.42   Mean   : 32.65   Mean   :59.97  
 3rd Qu.:57.65   3rd Qu.:15.10   3rd Qu.: 38.00   3rd Qu.:78.25  
 Max.   :99.70   Max.   :36.20   Max.   :147.00   Max.   :90.10  
 NA's   :4       NA's   :2       NA's   :4        NA's   :5      
    involact          income      
 Min.   :0.0000   Min.   : 5.583  
 1st Qu.:0.0000   1st Qu.: 8.564  
 Median :0.5000   Median :10.694  
 Mean   :0.6477   Mean   :10.736  
 3rd Qu.:0.9250   3rd Qu.:12.102  
 Max.   :2.2000   Max.   :21.480  
 NA's   :3        NA's   :2       </code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Detección de datos perdidos</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Por filas (casos)</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rowSums</span>(<span class="fu">is.na</span>(chmiss))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>60626 60640 60613 60657 60614 60610 60611 60625 60618 60647 60622 60631 60646 
    1     0     1     1     0     0     0     0     1     1     0     0     1 
60656 60630 60634 60641 60635 60639 60651 60644 60624 60612 60607 60623 60608 
    0     0     1     0     0     0     1     1     0     0     1     0     1 
60616 60632 60609 60653 60615 60638 60629 60636 60621 60637 60652 60620 60619 
    1     0     1     0     0     0     1     0     1     0     0     1     0 
60649 60617 60655 60643 60628 60627 60633 60645 
    1     1     0     0     1     0     0     1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(<span class="fu">is.na</span>(chmiss),<span class="at">axes=</span><span class="cn">FALSE</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">5</span><span class="sc">/</span><span class="dv">5</span>, <span class="at">labels=</span><span class="fu">colnames</span>(chmiss),<span class="at">las=</span><span class="dv">2</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">46</span><span class="sc">/</span><span class="dv">46</span>, <span class="at">labels=</span><span class="fu">row.names</span>(chmiss),<span class="at">las=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="p3c2-app9_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Por columnas (variables)</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(chmiss))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    race     fire    theft      age involact   income 
       4        2        4        5        3        2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mi)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>md <span class="ot">&lt;-</span> <span class="fu">missing_data.frame</span>(chmiss)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(md)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="p3c2-app9_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(md<span class="sc">@</span>patterns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> nothing involact      age    theft     race     fire   income 
      27        3        5        4        4        2        2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tratamiento de datos perdidos</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Omisión de observaciones (opción por defecto en R): </span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Resultados con datos completos</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>mod_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(involact <span class="sc">~</span> race<span class="sc">+</span>fire<span class="sc">+</span>theft<span class="sc">+</span>age<span class="sc">+</span><span class="fu">log</span>(income), chmiss)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = involact ~ race + fire + theft + age + log(income), 
    data = chmiss)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.59598 -0.19593 -0.05729  0.13641  0.63481 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -2.407202   1.419160  -1.696 0.104621    
race         0.011129   0.003443   3.232 0.003994 ** 
fire         0.045003   0.010696   4.208 0.000395 ***
theft       -0.016062   0.005550  -2.894 0.008678 ** 
age          0.009129   0.003443   2.652 0.014926 *  
log(income)  0.844261   0.531601   1.588 0.127196    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3392 on 21 degrees of freedom
  (20 observations deleted due to missingness)
Multiple R-squared:  0.7899,    Adjusted R-squared:  0.7399 
F-statistic: 15.79 on 5 and 21 DF,  p-value: 1.688e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputación simple</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Uso de la media para predecir los datos faltantes de los regresores</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>(cmeans <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(chmiss,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      race       fire      theft        age   involact     income 
35.6093023 11.4244444 32.6511628 59.9690476  0.6477273 10.7358667 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>imput_1 <span class="ot">&lt;-</span> chmiss</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">6</span>)) imput_1[<span class="fu">is.na</span>(chmiss[,i]),i] <span class="ot">&lt;-</span> cmeans[i] <span class="co"># Sólo var. expl.</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>mod_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(involact <span class="sc">~</span> race<span class="sc">+</span>fire<span class="sc">+</span>theft<span class="sc">+</span>age<span class="sc">+</span><span class="fu">log</span>(income), imput_1)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = involact ~ race + fire + theft + age + log(income), 
    data = imput_1)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.00582 -0.15772 -0.00159  0.22214  0.80666 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)  0.529635   1.087923   0.487  0.62917   
race         0.006975   0.002845   2.452  0.01893 * 
fire         0.028208   0.009541   2.956  0.00532 **
theft       -0.003310   0.002745  -1.206  0.23541   
age          0.006244   0.003160   1.976  0.05543 . 
log(income) -0.315826   0.390255  -0.809  0.42339   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3845 on 38 degrees of freedom
  (3 observations deleted due to missingness)
Multiple R-squared:  0.6813,    Adjusted R-squared:  0.6394 
F-statistic: 16.25 on 5 and 38 DF,  p-value: 1.461e-08</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Uso de regresiones para predecir los datos faltantes </span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># de las variables explicativas</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>mod_race <span class="ot">&lt;-</span> <span class="fu">lm</span>(race <span class="sc">~</span> fire<span class="sc">+</span>theft<span class="sc">+</span>age<span class="sc">+</span>income,chmiss)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>chmiss[<span class="fu">is.na</span>(chmiss<span class="sc">$</span>race),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      race fire theft  age involact income
60646   NA  5.7    11 27.9      0.0 16.250
60651   NA 15.1    30 89.8      0.8 10.510
60616   NA 12.2    46 48.0      0.6  8.212
60617   NA 10.8    34 58.0      0.9 11.156</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod_race,chmiss[<span class="fu">is.na</span>(chmiss<span class="sc">$</span>race),])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    60646     60651     60616     60617 
-17.84722  26.35970  70.39441  32.62029 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Como la predicción para la zona 60646 es negativa, </span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># se puede usar la transformación logit ( log(y/(1-y)) ) </span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># para evitar que las predicciones se salgan del intervalo [0,1] </span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># y luego aplicar la transformación inversa a la predicción</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(faraway)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>mod_race_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">logit</span>(race<span class="sc">/</span><span class="dv">100</span>) <span class="sc">~</span> fire<span class="sc">+</span>theft<span class="sc">+</span>age<span class="sc">+</span>income,chmiss)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ilogit</span>(<span class="fu">predict</span>(mod_race_2,chmiss[<span class="fu">is.na</span>(chmiss<span class="sc">$</span>race),]))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     60646      60651      60616      60617 
 0.4190909 14.7320193 84.2653995 21.3121261 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>mod_fire <span class="ot">&lt;-</span> <span class="fu">lm</span>(fire <span class="sc">~</span> race<span class="sc">+</span>theft<span class="sc">+</span>age<span class="sc">+</span>income,chmiss)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>chmiss[<span class="fu">is.na</span>(chmiss<span class="sc">$</span>fire),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      race fire theft age involact income
60607 50.2   NA   147  83      0.9  7.459
60608 55.5   NA    29  79      1.5  8.177</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod_fire,chmiss[<span class="fu">is.na</span>(chmiss<span class="sc">$</span>fire),])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   60607    60608 
50.23688 15.40465 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>mod_theft <span class="ot">&lt;-</span> <span class="fu">lm</span>(theft <span class="sc">~</span> race<span class="sc">+</span>fire<span class="sc">+</span>age<span class="sc">+</span>income,chmiss)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>chmiss[<span class="fu">is.na</span>(chmiss<span class="sc">$</span>theft),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      race fire theft  age involact income
60647 21.5 15.1    NA 89.8      1.1  9.631
60634  1.5  3.0    NA 51.2      0.0 12.198
60621 98.9 17.4    NA 68.6      2.2  7.520
60649 66.1 10.7    NA 67.5      0.4 10.908</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod_theft,chmiss[<span class="fu">is.na</span>(chmiss<span class="sc">$</span>theft),])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   60647    60634    60621    60649 
35.82849 20.86813 35.39362 38.04624 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>mod_age <span class="ot">&lt;-</span> <span class="fu">lm</span>(age <span class="sc">~</span> race<span class="sc">+</span>fire<span class="sc">+</span>theft<span class="sc">+</span>income,chmiss)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>chmiss[<span class="fu">is.na</span>(chmiss<span class="sc">$</span>age),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      race fire theft age involact income
60613 19.6 10.5    36  NA      1.2  9.948
60657 17.3  7.7    37  NA      0.5 10.656
60644 59.8 16.5    40  NA      0.8  9.784
60620 71.2 11.9    46  NA      0.9 11.040
60645  3.1  4.9    27  NA      0.0 13.731</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod_age,chmiss[<span class="fu">is.na</span>(chmiss<span class="sc">$</span>age),])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   60613    60657    60644    60620    60645 
74.11181 71.75477 64.29939 59.13367 45.83281 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>mod_income <span class="ot">&lt;-</span> <span class="fu">lm</span>(income <span class="sc">~</span> race<span class="sc">+</span>fire<span class="sc">+</span>theft<span class="sc">+</span>age,chmiss)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>chmiss[<span class="fu">is.na</span>(chmiss<span class="sc">$</span>income),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      race fire theft  age involact income
60609 46.2 21.8     4 73.1      1.3     NA
60628 35.1 15.6    28 57.8      1.0     NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod_income,chmiss[<span class="fu">is.na</span>(chmiss<span class="sc">$</span>income),])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    60609     60628 
 6.338472 10.190580 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generación de valores para los datos perdidos por variable</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>imput_2  <span class="ot">&lt;-</span> chmiss</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>imput_2<span class="sc">$</span>race[<span class="fu">is.na</span>(chmiss<span class="sc">$</span>race)] <span class="ot">&lt;-</span> </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ilogit</span>(<span class="fu">predict</span>(mod_race_2,chmiss[<span class="fu">is.na</span>(chmiss<span class="sc">$</span>race),]))<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>imput_2<span class="sc">$</span>fire[<span class="fu">is.na</span>(chmiss<span class="sc">$</span>fire)] <span class="ot">&lt;-</span> </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_fire,chmiss[<span class="fu">is.na</span>(chmiss<span class="sc">$</span>fire),])</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>imput_2<span class="sc">$</span>theft[<span class="fu">is.na</span>(chmiss<span class="sc">$</span>theft)] <span class="ot">&lt;-</span>  </span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_theft,chmiss[<span class="fu">is.na</span>(chmiss<span class="sc">$</span>theft),])</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>imput_2<span class="sc">$</span>age[<span class="fu">is.na</span>(chmiss<span class="sc">$</span>age)] <span class="ot">&lt;-</span>  </span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_age,chmiss[<span class="fu">is.na</span>(chmiss<span class="sc">$</span>age),])</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>imput_2<span class="sc">$</span>income[<span class="fu">is.na</span>(chmiss<span class="sc">$</span>income)] <span class="ot">&lt;-</span>  </span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_income,chmiss[<span class="fu">is.na</span>(chmiss<span class="sc">$</span>income),])</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>mod_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(involact <span class="sc">~</span> race<span class="sc">+</span>fire<span class="sc">+</span>theft<span class="sc">+</span>age<span class="sc">+</span><span class="fu">log</span>(income), imput_2)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = involact ~ race + fire + theft + age + log(income), 
    data = imput_2)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.7475 -0.1841 -0.0582  0.2203  0.8484 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -1.329475   1.212672  -1.096 0.279839    
race         0.009550   0.002627   3.635 0.000820 ***
fire         0.039664   0.009974   3.977 0.000303 ***
theft       -0.012791   0.003615  -3.539 0.001080 ** 
age          0.009848   0.003071   3.207 0.002723 ** 
log(income)  0.408210   0.443478   0.920 0.363132    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3581 on 38 degrees of freedom
  (3 observations deleted due to missingness)
Multiple R-squared:  0.7235,    Adjusted R-squared:  0.6872 
F-statistic: 19.89 on 5 and 38 DF,  p-value: 1.067e-09</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputación múltiple </span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Enfoque AMELIA (https://cran.r-project.org/web/packages/Amelia/index.html)</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Amelia)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>imput_3 <span class="ot">&lt;-</span> <span class="fu">amelia</span>(chmiss, <span class="at">m=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-- Imputation 1 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21 22 23 24 25 26 27 28 29 30 31 32 33 34

-- Imputation 2 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21 22 23 24 25 26 27 28 29 30 31

-- Imputation 3 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60
 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80
 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100
 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120
 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140
 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160
 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180
 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200
 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220
 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240
 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260
 261 262 263 264 265 266

-- Imputation 4 --

  1  2  3  4  5  6  7  8  9 10 11 12 13

-- Imputation 5 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21 22 23 24 25 26 27 28 29 30 31

-- Imputation 6 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21 22 23

-- Imputation 7 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40
 41 42 43 44

-- Imputation 8 --

  1  2  3  4  5  6  7  8

-- Imputation 9 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38

-- Imputation 10 --

  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
 21 22 23 24 25 26 27 28 29 30</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(imput_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Amelia output with 10 imputed datasets.
Return code:  1 
Message:  Normal EM convergence. 

Chain Lengths:
--------------
Imputation 1:  34
Imputation 2:  31
Imputation 3:  266
Imputation 4:  13
Imputation 5:  31
Imputation 6:  23
Imputation 7:  44
Imputation 8:  8
Imputation 9:  38
Imputation 10:  30

Rows after Listwise Deletion:  27 
Rows after Imputation:  47 
Patterns of missingness in the data:  7 

Fraction Missing for original variables: 
-----------------------------------------

         Fraction Missing
race           0.08510638
fire           0.04255319
theft          0.08510638
age            0.10638298
involact       0.06382979
income         0.04255319</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>betas <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>se_betas <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>imput_3<span class="sc">$</span>m){</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  lmod <span class="ot">&lt;-</span> <span class="fu">lm</span>(involact <span class="sc">~</span> race<span class="sc">+</span>fire<span class="sc">+</span>theft<span class="sc">+</span>age<span class="sc">+</span><span class="fu">log</span>(income), imput_3<span class="sc">$</span>imputations[[i]])</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  betas <span class="ot">&lt;-</span> <span class="fu">rbind</span>(betas ,<span class="fu">coef</span>(lmod))</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  se_betas <span class="ot">&lt;-</span> <span class="fu">rbind</span>(se_betas ,<span class="fu">coef</span>(<span class="fu">summary</span>(lmod))[,<span class="dv">2</span>])</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimaciones, desviaciones estándar estimadas y estadísticos t </span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="co"># (individuales y combinadas)</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>betas; se_betas</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      (Intercept)        race       fire         theft         age log(income)
 [1,]  -1.5525609 0.009937092 0.03870088 -0.0152888859 0.009631753  0.53071044
 [2,]  -1.9319807 0.009453789 0.04440711 -0.0160375613 0.009757833  0.68863489
 [3,]   0.2448739 0.007705441 0.03085692 -0.0009555429 0.003740203 -0.19107621
 [4,]  -1.3467722 0.009217949 0.04388865 -0.0142605811 0.008672619  0.44003774
 [5,]  -0.3409742 0.008060194 0.03501345 -0.0064161551 0.007061484  0.01934436
 [6,]  -1.1078476 0.008859360 0.04097190 -0.0113665740 0.007393054  0.36141559
 [7,]  -0.7420008 0.008563633 0.03355230 -0.0108660509 0.009499151  0.19525780
 [8,]  -0.5892517 0.007141891 0.03708851 -0.0087319441 0.008875525  0.12364921
 [9,]  -1.1094510 0.008858619 0.03494759 -0.0091012285 0.008898799  0.32620447
[10,]  -2.2949774 0.011578763 0.04380959 -0.0183111733 0.011214960  0.80341878</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>      (Intercept)        race        fire       theft         age log(income)
 [1,]   1.2433354 0.002496593 0.008429839 0.003644478 0.002822203   0.4603116
 [2,]   1.1233633 0.002063869 0.008161911 0.003113964 0.002497281   0.4180875
 [3,]   1.1425459 0.002893534 0.009577713 0.002689867 0.003029610   0.4140592
 [4,]   1.1266954 0.002299525 0.009287729 0.003372176 0.002712483   0.4170345
 [5,]   0.9521167 0.002407655 0.008675438 0.002243288 0.002676973   0.3432152
 [6,]   1.2043357 0.002573586 0.009052202 0.002993047 0.002627159   0.4432011
 [7,]   1.1022682 0.002430982 0.009130116 0.003280169 0.002702264   0.4048608
 [8,]   1.0496255 0.002455072 0.009714593 0.002891184 0.002693610   0.3847180
 [9,]   1.1039016 0.002453714 0.007685852 0.002389084 0.002596267   0.4039217
[10,]   1.0582906 0.002222866 0.008224091 0.003496879 0.002532884   0.3936320</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>(cr <span class="ot">&lt;-</span> <span class="fu">mi.meld</span>(<span class="at">q=</span>betas,<span class="at">se=</span>se_betas))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$q.mi
     (Intercept)        race       fire       theft         age log(income)
[1,]   -1.077094 0.008937673 0.03832369 -0.01113357 0.008474538   0.3297597

$se.mi
     (Intercept)        race       fire       theft        age log(income)
[1,]    1.367296 0.002767024 0.01015424 0.006197655 0.00344035      0.5193</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>(cr<span class="sc">$</span>q.mi<span class="sc">/</span>cr<span class="sc">$</span>se.mi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     (Intercept)     race     fire     theft      age log(income)
[1,]  -0.7877547 3.230067 3.774156 -1.796416 2.463278   0.6350081</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Enfoque MICE (https://cran.r-project.org/web/packages/mice/)</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Patrón de datos perdidos</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">md.pattern</span>(chmiss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="p3c2-app9_files/figure-html/unnamed-chunk-2-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   fire income involact race theft age   
27    1      1        1    1     1   1  0
5     1      1        1    1     1   0  1
4     1      1        1    1     0   1  1
4     1      1        1    0     1   1  1
3     1      1        0    1     1   1  1
2     1      0        1    1     1   1  1
2     0      1        1    1     1   1  1
      2      2        3    4     4   5 20</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputación simple con la media de los datos completos</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>imp_4_0 <span class="ot">&lt;-</span> <span class="fu">mice</span>(chmiss, <span class="at">method =</span> <span class="st">"mean"</span>, <span class="at">m =</span> <span class="dv">1</span>, <span class="at">maxit =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 iter imp variable
  1   1  race  fire  theft  age  involact  income</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>imput_1_2 <span class="ot">&lt;-</span> <span class="fu">complete</span>(imp_4_0) <span class="co"># Se obtiene el mismo resultado que </span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co"># en el fichero imput_1, pera también se imputan</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">with</span>(imput_1_2, <span class="fu">lm</span>(involact <span class="sc">~</span> race<span class="sc">+</span>fire<span class="sc">+</span>theft<span class="sc">+</span>age<span class="sc">+</span><span class="fu">log</span>(income))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = involact ~ race + fire + theft + age + log(income))

Residuals:
     Min       1Q   Median       3Q      Max 
-0.99102 -0.18765  0.01174  0.21644  0.82392 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)  0.628604   1.075959   0.584  0.56227   
race         0.006248   0.002765   2.259  0.02923 * 
fire         0.027110   0.009419   2.878  0.00632 **
theft       -0.003339   0.002716  -1.229  0.22599   
age          0.006754   0.003044   2.219  0.03209 * 
log(income) -0.345200   0.386098  -0.894  0.37650   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.381 on 41 degrees of freedom
Multiple R-squared:  0.6624,    Adjusted R-squared:  0.6212 
F-statistic: 16.09 on 5 and 41 DF,  p-value: 9.149e-09</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputación por el método de regresión (1):</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicción simple</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>imp_4_1 <span class="ot">&lt;-</span> <span class="fu">mice</span>(chmiss, <span class="at">method =</span> <span class="st">"norm.predict"</span>, <span class="at">m =</span> <span class="dv">1</span>, <span class="at">maxit =</span> <span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 iter imp variable
  1   1  race  fire  theft  age  involact  income</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>imput_2_1 <span class="ot">&lt;-</span> <span class="fu">complete</span>(imp_4_1) <span class="co"># Comparar con el fichero imput_2</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputación por el método de regresión (2):</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicción estocástica (se añade un error aleatorio)</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>imp_4_2 <span class="ot">&lt;-</span> <span class="fu">mice</span>(chmiss, <span class="at">method =</span> <span class="st">"norm.nob"</span>, <span class="at">m =</span> <span class="dv">1</span>, <span class="at">maxit =</span> <span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 iter imp variable
  1   1  race  fire  theft  age  involact  income</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>imput_2_2 <span class="ot">&lt;-</span> <span class="fu">complete</span>(imp_4_2) <span class="co"># Comparar con el fichero imput_2</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputación por el método de regresión (3):</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicción usando booostrap</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>imp_4_3 <span class="ot">&lt;-</span> <span class="fu">mice</span>(chmiss, <span class="at">method =</span> <span class="st">"norm.boot"</span>, <span class="at">m =</span> <span class="dv">1</span>, <span class="at">maxit =</span> <span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 iter imp variable
  1   1  race  fire  theft  age  involact  income</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>imput_2_3 <span class="ot">&lt;-</span> <span class="fu">complete</span>(imp_4_3) <span class="co"># Comparar con el fichero imput_2</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co"># MICE: Multiple Imputation Chained Equation</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>imp_4 <span class="ot">&lt;-</span> <span class="fu">mice</span>(chmiss, <span class="at">m =</span> <span class="dv">10</span>, <span class="at">print=</span>F)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(imp_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Class: mids
Number of multiple imputations:  10 
Imputation methods:
    race     fire    theft      age involact   income 
   "pmm"    "pmm"    "pmm"    "pmm"    "pmm"    "pmm" 
PredictorMatrix:
         race fire theft age involact income
race        0    1     1   1        1      1
fire        1    0     1   1        1      1
theft       1    1     0   1        1      1
age         1    1     1   0        1      1
involact    1    1     1   1        0      1
income      1    1     1   1        1      0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(imp_4) <span class="co"># mids: multiply imputed data set</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "mids"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(imp_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$names
 [1] "data"            "imp"             "m"               "where"          
 [5] "blocks"          "call"            "nmis"            "method"         
 [9] "predictorMatrix" "visitSequence"   "formulas"        "post"           
[13] "blots"           "ignore"          "seed"            "iteration"      
[17] "lastSeedValue"   "chainMean"       "chainVar"        "loggedEvents"   
[21] "version"         "date"           

$class
[1] "mids"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Para ver los datos imputados de una variable</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>imp_4<span class="sc">$</span>imp <span class="co"># Todas las imputaciones</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$race
         1    2    3    4    5    6    7    8    9   10
60646  1.5  1.1  4.4  1.8  1.6  7.1  7.1  1.0  1.8  1.0
60651 17.3 66.1 59.8 17.3 34.0 22.2 42.5 47.4 73.5 71.2
60616 54.0 90.6 35.1 90.6 74.2 21.5 55.5 71.2 54.0 54.0
60617 48.8 71.2 19.6 71.2 21.5 59.8 24.5 71.2 66.1 73.5

$fire
         1    2    3    4    5    6    7    8    9   10
60607 36.2 17.4 18.5 18.4 29.1 17.4 29.1 18.5 29.1 29.1
60608 10.5 18.4 18.4 18.5 10.5 21.6  8.6 10.5 34.1 21.6

$theft
       1  2  3  4  5  6  7  8  9 10
60647 18 37 32 23 46 34 42 27 44 46
60634 14 14 27  9 22 22 14 23 32 42
60621 29 14 11 27 11 11 36 14 19  3
60649 41 31 75 41 31 37 18 27 41 27

$age
         1    2    3    4    5    6    7    8    9   10
60613 68.6 82.7 72.9 82.7 83.0 63.1 81.4 63.1 79.0 63.1
60657 63.1 90.1 78.1 89.8 90.1 78.1 71.5 65.0 65.0 57.8
60644 65.0 61.8 63.8 85.1 76.5 71.5 71.5 73.4 65.0 90.1
60620 63.8 78.1 55.9 61.8 90.1 84.2 90.1 73.1 60.4 72.9
60645 78.5 40.2 11.4 40.2 44.4 49.2 44.4  7.7 20.8 15.2

$involact
        1   2   3   4   5 6   7   8   9  10
60626 0.0 0.3 0.3 0.0 0.0 0 0.0 0.3 0.3 0.0
60618 0.3 0.9 0.3 0.2 0.5 0 0.2 0.7 1.2 0.2
60629 0.0 0.3 0.0 0.0 0.0 0 0.0 0.0 0.0 0.0

$income
           1     2      3      4      5      6      7     8     9    10
60609  7.388 9.631 10.332 10.908 10.510  9.631 11.040 8.212 9.742 7.388
60628 11.156 9.948  7.459 10.694 11.084 11.156  8.212 9.323 9.948 9.323</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputaciones para una variable: </span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="co"># cambiar race por otra variable para ver el resultado</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>imp_4<span class="sc">$</span>imp<span class="sc">$</span>race </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         1    2    3    4    5    6    7    8    9   10
60646  1.5  1.1  4.4  1.8  1.6  7.1  7.1  1.0  1.8  1.0
60651 17.3 66.1 59.8 17.3 34.0 22.2 42.5 47.4 73.5 71.2
60616 54.0 90.6 35.1 90.6 74.2 21.5 55.5 71.2 54.0 54.0
60617 48.8 71.2 19.6 71.2 21.5 59.8 24.5 71.2 66.1 73.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Para guardar los datos completos de una imputación</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>imp_4_m_1 <span class="ot">&lt;-</span> <span class="fu">complete</span>(imp_4,<span class="dv">1</span>) <span class="co"># cambiar 1 por cualquier valor entre 1 y 10</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspección de la calidad de las imputaciones</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convergencia del algoritmo (iterative Markov Chain Monte Carlo)</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(imp_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="p3c2-app9_files/figure-html/unnamed-chunk-2-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="p3c2-app9_files/figure-html/unnamed-chunk-2-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica conjunta</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stripplot</span>(imp_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="p3c2-app9_files/figure-html/unnamed-chunk-2-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica individual</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stripplot</span>(imp_4, involact, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">xlab =</span> <span class="st">"Imputation number"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="p3c2-app9_files/figure-html/unnamed-chunk-2-7.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stripplot</span>(imp_4, race, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">xlab =</span> <span class="st">"Imputation number"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="p3c2-app9_files/figure-html/unnamed-chunk-2-8.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stripplot</span>(imp_4, fire, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">xlab =</span> <span class="st">"Imputation number"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="p3c2-app9_files/figure-html/unnamed-chunk-2-9.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stripplot</span>(imp_4, theft, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">xlab =</span> <span class="st">"Imputation number"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="p3c2-app9_files/figure-html/unnamed-chunk-2-10.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stripplot</span>(imp_4, age, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">xlab =</span> <span class="st">"Imputation number"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="p3c2-app9_files/figure-html/unnamed-chunk-2-11.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stripplot</span>(imp_4, income, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">xlab =</span> <span class="st">"Imputation number"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="p3c2-app9_files/figure-html/unnamed-chunk-2-12.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribución de los datos completos y los completados</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(imp_4,involact <span class="sc">~</span> race<span class="sc">+</span>fire<span class="sc">+</span>theft<span class="sc">+</span>age<span class="sc">+</span>income)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="p3c2-app9_files/figure-html/unnamed-chunk-2-13.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">densityplot</span>(imp_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="p3c2-app9_files/figure-html/unnamed-chunk-2-14.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuste de los modelos con los datos completados (m modelos)</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">with</span>(imp_4, <span class="fu">lm</span>(involact <span class="sc">~</span> race<span class="sc">+</span>fire<span class="sc">+</span>theft<span class="sc">+</span>age<span class="sc">+</span><span class="fu">log</span>(income)))</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Pool y resumen de resultados</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>fit <span class="co"># Resultado de la regresión para cada conjunto de datos imputados (m=10 en el ejemplo)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>call :
with.mids(data = imp_4, expr = lm(involact ~ race + fire + theft + 
    age + log(income)))

call1 :
mice(data = chmiss, m = 10, printFlag = F)

nmis :
    race     fire    theft      age involact   income 
       4        2        4        5        3        2 

analyses :
[[1]]

Call:
lm(formula = involact ~ race + fire + theft + age + log(income))

Coefficients:
(Intercept)         race         fire        theft          age  log(income)  
  -0.599910     0.009319     0.036267    -0.009063     0.007314     0.127509  


[[2]]

Call:
lm(formula = involact ~ race + fire + theft + age + log(income))

Coefficients:
(Intercept)         race         fire        theft          age  log(income)  
   0.121086     0.005899     0.033715    -0.005583     0.007738    -0.167841  


[[3]]

Call:
lm(formula = involact ~ race + fire + theft + age + log(income))

Coefficients:
(Intercept)         race         fire        theft          age  log(income)  
   0.230438     0.006959     0.033557    -0.005745     0.005959    -0.177621  


[[4]]

Call:
lm(formula = involact ~ race + fire + theft + age + log(income))

Coefficients:
(Intercept)         race         fire        theft          age  log(income)  
  -0.437711     0.007982     0.035852    -0.005749     0.007089     0.037169  


[[5]]

Call:
lm(formula = involact ~ race + fire + theft + age + log(income))

Coefficients:
(Intercept)         race         fire        theft          age  log(income)  
  -0.243150     0.007204     0.036488    -0.008048     0.007791    -0.019826  


[[6]]

Call:
lm(formula = involact ~ race + fire + theft + age + log(income))

Coefficients:
(Intercept)         race         fire        theft          age  log(income)  
   0.095326     0.007493     0.035017    -0.005226     0.005428    -0.139136  


[[7]]

Call:
lm(formula = involact ~ race + fire + theft + age + log(income))

Coefficients:
(Intercept)         race         fire        theft          age  log(income)  
   0.168600     0.007552     0.031955    -0.006110     0.006584    -0.173716  


[[8]]

Call:
lm(formula = involact ~ race + fire + theft + age + log(income))

Coefficients:
(Intercept)         race         fire        theft          age  log(income)  
   0.373117     0.006646     0.030627    -0.005362     0.006434    -0.237995  


[[9]]

Call:
lm(formula = involact ~ race + fire + theft + age + log(income))

Coefficients:
(Intercept)         race         fire        theft          age  log(income)  
  -0.092063     0.006544     0.032811    -0.007120     0.007919    -0.065382  


[[10]]

Call:
lm(formula = involact ~ race + fire + theft + age + log(income))

Coefficients:
(Intercept)         race         fire        theft          age  log(income)  
   0.131407     0.006564     0.037846    -0.007256     0.005088    -0.123178  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Para ver el resultado de una regresión concreta (la primera por ejemplo)</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit<span class="sc">$</span>analyses[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = involact ~ race + fire + theft + age + log(income))

Residuals:
     Min       1Q   Median       3Q      Max 
-0.87720 -0.15182 -0.05708  0.20480  0.76808 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.599910   1.088705  -0.551 0.584603    
race         0.009319   0.002555   3.648 0.000739 ***
fire         0.036267   0.009371   3.870 0.000382 ***
theft       -0.009063   0.002895  -3.131 0.003209 ** 
age          0.007314   0.002783   2.628 0.012024 *  
log(income)  0.127509   0.396047   0.322 0.749122    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3506 on 41 degrees of freedom
Multiple R-squared:  0.728, Adjusted R-squared:  0.6949 
F-statistic: 21.95 on 5 and 41 DF,  p-value: 1.244e-10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pool de resultados de regresión</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">pool</span>(fit))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         term     estimate   std.error   statistic       df      p.value
1 (Intercept) -0.025286073 1.092690052 -0.02314112 34.53745 0.9816708904
2        race  0.007216278 0.002705433  2.66732786 31.55176 0.0119609194
3        fire  0.034413473 0.009405569  3.65883993 36.04671 0.0008041661
4       theft -0.006526315 0.002962423 -2.20303287 26.95465 0.0363243930
5         age  0.006734236 0.002916411  2.30908328 31.93569 0.0275622318
6 log(income) -0.094001521 0.397330269 -0.23658283 34.56589 0.8143768712</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparación de los resultados a posteriori, con la muestra completa</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(chredlin, <span class="at">package=</span><span class="st">"faraway"</span>)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>mod_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(involact <span class="sc">~</span> race<span class="sc">+</span>fire<span class="sc">+</span>theft<span class="sc">+</span>age<span class="sc">+</span><span class="fu">log</span>(income), chredlin)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = involact ~ race + fire + theft + age + log(income), 
    data = chredlin)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.85393 -0.16922 -0.03088  0.17890  0.81228 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -1.185540   1.100255  -1.078 0.287550    
race         0.009502   0.002490   3.817 0.000449 ***
fire         0.039856   0.008766   4.547 4.76e-05 ***
theft       -0.010295   0.002818  -3.653 0.000728 ***
age          0.008336   0.002744   3.038 0.004134 ** 
log(income)  0.345762   0.400123   0.864 0.392540    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3345 on 41 degrees of freedom
Multiple R-squared:  0.7517,    Adjusted R-squared:  0.7214 
F-statistic: 24.83 on 5 and 41 DF,  p-value: 2.009e-11</code></pre>
</div>
</div>
</section>
<section id="código-python" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="código-python">Código Python</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lectura de librerías</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Lectura de datos</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>chmiss <span class="op">=</span> pd.read_csv(<span class="st">"data/SEGUROS_CHICAGO.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>chmiss.describe().<span class="bu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        race   fire   theft    age  involact  income
count  43.00  45.00   43.00  42.00     44.00   45.00
mean   35.61  11.42   32.65  59.97      0.65   10.74
std    33.26   8.36   23.12  23.62      0.64    2.79
min     1.00   2.00    3.00   2.00      0.00    5.58
25%     3.75   5.60   22.00  48.30      0.00    8.56
50%    24.50   9.50   29.00  64.40      0.50   10.69
75%    57.65  15.10   38.00  78.25      0.92   12.10
max    99.70  36.20  147.00  90.10      2.20   21.48</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Detección de datos perdidos</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Por filas (casos)</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>chmiss.isna().<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>zip
60626    1
60640    0
60613    1
60657    1
60614    0
60610    0
60611    0
60625    0
60618    1
60647    1
60622    0
60631    0
60646    1
60656    0
60630    0
60634    1
60641    0
60635    0
60639    0
60651    1
60644    1
60624    0
60612    0
60607    1
60623    0
60608    1
60616    1
60632    0
60609    1
60653    0
60615    0
60638    0
60629    1
60636    0
60621    1
60637    0
60652    0
60620    1
60619    0
60649    1
60617    1
60655    0
60643    0
60628    1
60627    0
60633    0
60645    1
dtype: int64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>plt.imshow(<span class="op">~</span>chmiss.isna(), aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"variables"</span>)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"cases"</span>)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>plt.gray()</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="p3c2-app9_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="614"></p>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Por columnas (variables)</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>chmiss.isna().<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>race        4
fire        2
theft       4
age         5
involact    3
income      2
dtype: int64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tratamiento de datos perdidos</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Omisión de los datos perdidos: resultados con datos completos</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>mod_1 <span class="op">=</span> smf.ols(formula<span class="op">=</span><span class="st">'involact ~ race + fire + theft + age + np.log(income)'</span>, data<span class="op">=</span>chmiss).fit()</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mod_1.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            OLS Regression Results                            
==============================================================================
Dep. Variable:               involact   R-squared:                       0.790
Model:                            OLS   Adj. R-squared:                  0.740
Method:                 Least Squares   F-statistic:                     15.79
Date:                Wed, 15 Nov 2023   Prob (F-statistic):           1.69e-06
Time:                        09:50:31   Log-Likelihood:                -5.7253
No. Observations:                  27   AIC:                             23.45
Df Residuals:                      21   BIC:                             31.23
Df Model:                           5                                         
Covariance Type:            nonrobust                                         
==================================================================================
                     coef    std err          t      P&gt;|t|      [0.025      0.975]
----------------------------------------------------------------------------------
Intercept         -2.4072      1.419     -1.696      0.105      -5.359       0.544
race               0.0111      0.003      3.232      0.004       0.004       0.018
fire               0.0450      0.011      4.208      0.000       0.023       0.067
theft             -0.0161      0.006     -2.894      0.009      -0.028      -0.005
age                0.0091      0.003      2.652      0.015       0.002       0.016
np.log(income)     0.8443      0.532      1.588      0.127      -0.261       1.950
==============================================================================
Omnibus:                        1.216   Durbin-Watson:                   2.453
Prob(Omnibus):                  0.545   Jarque-Bera (JB):                0.935
Skew:                           0.441   Prob(JB):                        0.626
Kurtosis:                       2.768   Cond. No.                     1.89e+03
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 1.89e+03. This might indicate that there are
strong multicollinearity or other numerical problems.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputación simple: uso de la media para predecir los datos faltantes de los regresores</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>cmeans <span class="op">=</span> chmiss.mean(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>cmeans</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>race        35.609302
fire        11.424444
theft       32.651163
age         59.969048
involact     0.647727
income      10.735867
dtype: float64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>imput_1 <span class="op">=</span> chmiss.copy()</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>imput_1.race.fillna(cmeans[<span class="st">'race'</span>],inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>imput_1.fire.fillna(cmeans[<span class="st">'fire'</span>],inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>imput_1.theft.fillna(cmeans[<span class="st">'theft'</span>],inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>imput_1.age.fillna(cmeans[<span class="st">'age'</span>],inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>imput_1.income.fillna(cmeans[<span class="st">'income'</span>],inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>mod_2 <span class="op">=</span> smf.ols(formula<span class="op">=</span><span class="st">'involact ~ race + fire + theft + age + np.log(income)'</span>, data<span class="op">=</span>imput_1).fit()</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mod_2.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            OLS Regression Results                            
==============================================================================
Dep. Variable:               involact   R-squared:                       0.681
Model:                            OLS   Adj. R-squared:                  0.639
Method:                 Least Squares   F-statistic:                     16.25
Date:                Wed, 15 Nov 2023   Prob (F-statistic):           1.46e-08
Time:                        09:50:31   Log-Likelihood:                -17.153
No. Observations:                  44   AIC:                             46.31
Df Residuals:                      38   BIC:                             57.01
Df Model:                           5                                         
Covariance Type:            nonrobust                                         
==================================================================================
                     coef    std err          t      P&gt;|t|      [0.025      0.975]
----------------------------------------------------------------------------------
Intercept          0.5296      1.088      0.487      0.629      -1.673       2.732
race               0.0070      0.003      2.452      0.019       0.001       0.013
fire               0.0282      0.010      2.956      0.005       0.009       0.048
theft             -0.0033      0.003     -1.206      0.235      -0.009       0.002
age                0.0062      0.003      1.976      0.055      -0.000       0.013
np.log(income)    -0.3158      0.390     -0.809      0.423      -1.106       0.474
==============================================================================
Omnibus:                        1.687   Durbin-Watson:                   2.026
Prob(Omnibus):                  0.430   Jarque-Bera (JB):                0.817
Skew:                          -0.219   Prob(JB):                        0.665
Kurtosis:                       3.504   Cond. No.                     1.68e+03
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 1.68e+03. This might indicate that there are
strong multicollinearity or other numerical problems.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputación múltiple: enfoque MICE </span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (https://www.statsmodels.org/stable/imputation.html)</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="co"># NOTA: la librería statsmodels incluye el método MICE, pero no es </span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="co"># exactamente el mismo que el usado en R</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.imputation.mice <span class="im">as</span> smimice</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>imp <span class="op">=</span> smimice.MICEData(chmiss)</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>formula <span class="op">=</span> <span class="st">'involact ~ race + fire + theft + age + np.log(income)'</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>mod_3 <span class="op">=</span> smimice.MICE(formula, sm.OLS, imp)</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> mod_3.fit(<span class="dv">10</span>, <span class="dv">10</span>)</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(results.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           Results: MICE
====================================================================
Method:                   MICE           Sample size:           47  
Model:                    OLS            Scale                  0.14
Dependent variable:       involact       Num. imputations       10  
--------------------------------------------------------------------
                Coef.  Std.Err.    t    P&gt;|t|   [0.025 0.975]  FMI  
--------------------------------------------------------------------
Intercept       0.1845   1.1791  0.1565 0.8756 -2.1264 2.4954 0.1010
race            0.0072   0.0028  2.5197 0.0117  0.0016 0.0127 0.0684
fire            0.0310   0.0095  3.2505 0.0012  0.0123 0.0497 0.0660
theft          -0.0036   0.0038 -0.9531 0.3405 -0.0111 0.0038 0.5374
age             0.0060   0.0033  1.8094 0.0704 -0.0005 0.0124 0.2466
np.log(income) -0.1791   0.4260 -0.4205 0.6741 -1.0141 0.6558 0.0996
====================================================================</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./p3c2-app8b.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Aplicación 3.8b (Dependencia espacial - Geometría: puntos): Precio de la vivienda en el condado de Lucas [Ohio, Estados Unidos]</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./p3c2-app10.html" class="pagination-link">
        <span class="nav-page-text">Aplicación 3.10 (Información muestral - Multicolinealidad): Análisis de la rentabilidad empresarial</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>