---
title: "USA_Housing prices regression"
output:
  html_document:
    df_print: paged
---

```{python}
import pandas as pd
import numpy as np
import statsmodels.api as sm
import statsmodels.formula.api as smf
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn import metrics
#
df = pd.read_csv('USA_Housing.csv')
df.info()
df.head()
df.drop('Address', inplace=True, axis=1)
df.describe()
#
plt.figure(1)
sns.pairplot(df)
plt.show()
#
plt.figure(2)
sns.heatmap(df.corr(), annot=True)
plt.show()
# stamodels package regression
df_new = df.rename(columns={'Avg. Area Income': 'Income', 'Avg. Area House Age': 'Age', 'Avg. Area Number of Rooms': 'Rooms', 'Avg. Area Number of Bedrooms': 'Bedrooms', 'Area Population': 'Population'})
ols_results_1 = smf.ols('Price ~ Income + Age + Rooms + Bedrooms + Population', data=df_new).fit()
print(ols_results_1.summary())
# s
X = df[['Avg. Area Income', 'Avg. Area House Age', 'Avg. Area Number of Rooms',
               'Avg. Area Number of Bedrooms', 'Area Population']]
y = df['Price']
#
CX = sm.add_constant(X)
ols_results_2 = sm.OLS(y, CX).fit()
print(ols_results_2.summary())
# scikit-learn (ML) package regression
# X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=.30)
# model.fit(X_train,y_train)
model=LinearRegression()
model.fit(X,y)
coeff_model = pd.DataFrame(model.coef_, X.columns, columns=['Coefficient'])
coeff_model
```


