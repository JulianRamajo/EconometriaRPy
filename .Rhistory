library(tidyverse)
library(sf)
system.file("gpkg/nc.gpkg", package = "sf") %>% read_sf() -> nc
View(nc)
nc.32119 <- st_transform(nc, 'EPSG:32119')
nc.32119 %>%
select(BIR74) %>%
plot(graticule = TRUE, axes = TRUE)
library(spatialreg)
eigs_489 <- eigenw(lw_q_489)
SDEM_489 <- errorsarlm(form, data = boston_489, listw = lw_q_489, Durbin = TRUE,
zero.policy = TRUE, control = list(pre_eig = eigs_489))
rm(list=ls())
install.packages(c("gld", "httpuv", "igraph", "knitr", "ks", "openxlsx", "parallelly", "ragg", "rgdal", "rgeos", "spatstat.data", "spatstat.sparse", "spdep", "systemfonts", "xfun"))
install.packages("tmap")
library(tmap)
data("World")
tm_shape(World) +
tm_polygons("HPI")
View(World)
tmap_mode("view")
tm_shape(World) +
tm_polygons("HPI")
install.packages("mapview")
library(mapview)
mapview(breweries)
data("breweries")
force(breweries)
View(breweries)
install.packages(c("blogdown", "ctv", "gld", "glue", "h2o", "igraph", "ks", "mclust", "openssl", "progressr", "ragg", "RcppArmadillo", "sf", "spatstat.sparse", "stars", "systemfonts", "tinytex", "tufte"))
library(sf)
library(sp)
library(spData)
boston_506 <- st_read(system.file("shapes/boston_tracts.shp", package = "spData")[1])
View(boston_506)
nb_q <- spdep::poly2nb(boston_506)
lw_q <- spdep::nb2listw(nb_q, style = "W")
View(lw_q)
summary(boston_506$median)
boston_506$CHAS <- as.factor(boston_506$CHAS)
boston_489 <- boston_506[!is.na(boston_506$median),]
nb_q_489 <- spdep::poly2nb(boston_489)
lw_q_489 <- spdep::nb2listw(nb_q_489, style = "W", zero.policy = TRUE)
agg_96 <- list(as.character(boston_506$NOX_ID))
boston_96 <- aggregate(boston_506[, "NOX_ID"], by = agg_96, unique)
nb_q_96 <- spdep::poly2nb(boston_96)
lw_q_96 <- spdep::nb2listw(nb_q_96)
boston_96$NOX <- aggregate(boston_506$NOX, agg_96, mean)$x
boston_96$CHAS <- aggregate(as.integer(boston_506$CHAS)-1, agg_96, max)$x
nms <- names(boston_506)
ccounts <- 23:31
for (nm in nms[c(22, ccounts, 36)]) {
boston_96[[nm]] <- aggregate(boston_506[[nm]], agg_96, sum)$x
}
br2 <- c(3.50, 6.25, 8.75, 12.50, 17.50, 22.50, 30.00, 42.50, 60.00)*1000
counts <- as.data.frame(boston_96)[, nms[ccounts]]
f <- function(x) matrixStats::weightedMedian(x = br2, w = x, interpolate = TRUE)
boston_96$median <- apply(counts, 1, f)
is.na(boston_96$median) <- boston_96$median > 50000
summary(boston_96$median)
boston_94 <- boston_96[!is.na(boston_96$median),]
nb_q_94 <- spdep::subset.nb(nb_q_96, !is.na(boston_96$median))
lw_q_94 <- spdep::nb2listw(nb_q_94, style="W")
boston_94a <- aggregate(boston_489[,"NOX_ID"], list(boston_489$NOX_ID), unique)
nb_q_94a <- spdep::poly2nb(boston_94a)
NOX_ID_no_neighs <- boston_94a$NOX_ID[which(spdep::card(nb_q_94a) == 0)]
boston_487 <- boston_489[is.na(match(boston_489$NOX_ID, NOX_ID_no_neighs)),]
boston_93 <- aggregate(boston_487[, "NOX_ID"], list(ids = boston_487$NOX_ID), unique)
row.names(boston_93) <- as.character(boston_93$NOX_ID)
nb_q_93 <- spdep::poly2nb(boston_93, row.names=unique(as.character(boston_93$NOX_ID)))
form <- formula(log(median) ~ CRIM + ZN + INDUS + CHAS + I((NOX*10)^2) + I(RM^2) +
AGE + log(DIS) + log(RAD) + TAX + PTRATIO + I(BB/100) +
log(I(LSTAT/100)))
library(Matrix)
library(lme4)
MLM <- lmer(update(form, . ~ . + (1 | NOX_ID)), data = boston_487, REML = FALSE)
boston_93$MLM_re <- ranef(MLM)[[1]][,1]
library(spatialreg)
eigs_489 <- eigenw(lw_q_489)
SDEM_489 <- errorsarlm(form, data = boston_489, listw = lw_q_489, Durbin = TRUE,
zero.policy = TRUE, control = list(pre_eig = eigs_489))
SEM_489 <- errorsarlm(form, data = boston_489, listw = lw_q_489,
zero.policy = TRUE, control = list(pre_eig = eigs_489))
summary(SDEM_489)
summary(SEM_489)
SLX_489 <- lmSLX(form, data = boston_489, listw = lw_q_489)
SLX_489 <- lmSLX(form, data = boston_489, listw = lw_q_489, zero.policy = TRUE)
summary(SLX_489)
rm(list=ls())
library(reticulate)
py_install("pmdarima")
miniconda_update()
conda_list()
install.packages("heplots")
install.packages("geodata")
install.packages(c("ragg", "RPostgres", "rstan", "systemfonts"))
install.packages("CausalImpact")
install.packages(c("ragg", "raster", "shinyjs", "systemfonts", "V8"))
library(reticulate)
py_install("glmnet")
miniconda_update()
py_install("pymc3")
install.packages(c("ragg", "raster", "systemfonts", "V8"))
install.packages(c("broom", "carData", "compositions", "datawizard", "DEoptimR", "distributional", "emmeans", "gert", "ggfortify", "graphlayouts", "h2o", "highcharter", "htmlTable", "httpuv", "igraph", "mapsf", "multcomp", "ragg", "RcmdrMisc", "RcppParallel", "repr", "spam", "spdep", "sphet", "ssfa", "systemfonts", "wk"))
setwd("~/OneDrive - Universidad de Extremadura/2 - DOCENCIA/0 - ECONOMETRÍA/1 - ECONOMETRÍA CON R-PYTHON-JULIA/_GitHub")
# Lectura de librerías
library(tidyverse)
library(alr4)
library(AER)
library(MASS)
# Lectura de datos
AMS_PhDsMATH <- read_csv("AMS_PhDsMATH.csv")
summary(AMS_PhDsMATH)
View(AMS_PhDsMATH)
# Modelo de Poisson
modelo_Poisson <- glm(count ~ type*sex + type*citizen, family = poisson, AMS_PhDsMATH)
S(modelo_Poisson)
Anova(modelo_Poisson)
# Gráficas parciales
plot(Effect(c("type", "citizen"), modelo_Poisson), multiline=TRUE, ci.style="bars", main="",
xlab="Tipo de programa de doctorado",
ylab="Número de nuevos Doctores",
rescale.axis=FALSE, grid=TRUE)
plot(Effect(c("type", "sex"), modelo_Poisson), multiline=TRUE, ci.style="bars", main="",
xlab="Tipo de programa de doctorado",
ylab="Número de nuevos Doctores",
rescale.axis=FALSE, grid=TRUE)
# Contrastes de sobredispersión
dispersiontest(modelo_Poisson)
dispersiontest(modelo_Poisson, trafo = 2)
# Modelos alternativos cuando se rechaza la hipótesis nula de equidispersión (varianza=media)
# Modelo quasiPoisson (errores estándar QMLE robustos) [binomial negativa con función de varianza lineal, NB1]
modelo_quasiPoisson <- glm(count ~ type*sex + type*citizen, family = quasipoisson, AMS_PhDsMATH)
S(modelo_quasiPoisson)
Anova(modelo_quasiPoisson)
# Modelo Binomial Negativo (NB2)
modelo_BinNeg <- glm.nb(count ~ type*sex + type*citizen, data = AMS_PhDsMATH)
S(modelo_BinNeg)
#
library(reticulate)
repl_python()
Anova(modelo_BinNeg)
rm(list = ls())
