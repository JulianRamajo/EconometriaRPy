---
title: 'TEMA 3: Regresores endógenos: el estimador de variables instrumentales (VI)'
author:
  name: Julián Ramajo, ramajo@unex.es
  affiliation: GRADO EN ESTADÍSTICA | ECONOMETRIA (502243)
subtitle: 'Aplicación 3.11 : Determinantes de la inflación al nivel internacional'
output:
  html_document:
    theme: journal
    highlight: haddock
    toc: yes
    toc_depth: 2
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '2'
---

# Introducción

Para explicar las variaciones que se producen en la inflación observada al nivel internacional (muestra de 76 países) se propone el siguiente modelo econométrico, el cual se obtiene de la teoría cuantitativa del dinero:

$$INF_{i} = \beta_1 + \beta_2 RM_{i} + \beta_3 RY_{i} + e_{i}$$

siendo _INF_ la inflación (tasa de variación del índice general de precios), _RM_ la tasa de crecimiento de la oferta monetaria, y _RY_ la tasa de crecimiento del PIB.

Se asumirá que la variable _RM_ es exógena (política monetaria independiente), mientras que se supondrá que la variable _RY_ podría ser endógena y, por tanto, puede estar correlacionada con el término de error del modelo, $$Cov(RY,e)≠0$$

Como instrumentos para _RY_ se tomarán el nivel inicial de PIB per cápita ( _YPC0_ ), el nivel de educación relativo de la población ( _EDUC_ ), el nivel de inversión ( _INV_ ) y la tasa de crecimiento de la población ( _RPOB_ ), 

# Código R

```{r, message=FALSE}
# Lectura de librerías
library(tidyverse)
library(ivreg)
# Para más detalles sobre el método de variables instrumentales (IV o 2SLS en inglés) 
# ver las páginas web: 
# https://cran.r-project.org/web/packages/ivreg/vignettes/ivreg.html 
# https://cran.r-project.org/web/packages/ivreg/vignettes/Diagnostics-for-2SLS-Regression.html
#
# Lectura de datos
INF_INT <- read_csv("INF_INTERN.csv")
summary(INF_INT)
# Estimación MCO
modelo_MCO <- lm(INF ~ RM + RY, data=INF_INT)
summary(modelo_MCO)
# Estimación VI
modelo_IV <- ivreg(INF ~ RM + RY | RM + EDUC + INV + RPOB + YPC0, data=INF_INT)
summary(modelo_IV, diagnostics=TRUE)
# Comparación de modelos
car::compareCoefs(modelo_MCO, modelo_IV)
library("modelsummary")
model_list <- list(OLS = modelo_MCO, IV = modelo_IV)
msummary(model_list)
modelplot(model_list)
```

# Código Python

```{python, message=FALSE}
# Lectura de librerías
import pandas as pd
import numpy as np
import statsmodels.api as sm
from linearmodels.iv import IV2SLS
# Lectura de datos
INF_INT = pd.read_csv('INF_INTERN.csv')
INF_INT.describe()
#
# Estimación MCO
INF_INT = sm.add_constant(INF_INT)
modelo_MCO = IV2SLS(dependent = INF_INT.INF,
               exog = INF_INT[['const','RM','RY']], 
               endog = None, 
               instruments = None)
res_modelo_MCO = modelo_MCO.fit(cov_type='unadjusted')
print(res_modelo_MCO)
# Estimación IV (2SLS)
modelo_IV = IV2SLS(dependent = INF_INT.INF,
               exog = INF_INT[['const','RM']],
               endog = INF_INT.RY,
               instruments = INF_INT[['EDUC','INV','RPOB','YPC0']])
res_modelo_IV = modelo_IV.fit(cov_type='unadjusted')
print(res_modelo_IV)
res_modelo_IV.wu_hausman()
# Comparación de resultados
from collections import OrderedDict
from linearmodels.iv.results import compare
res_modelos = OrderedDict()
res_modelos["MCO"] = res_modelo_MCO
res_modelos["IV"] = res_modelo_IV
print(compare(res_modelos))
```

# Código Julia

```{r, echo = FALSE}
library(JuliaCall)
julia <- julia_setup()
```

```{julia, message = FALSE, warning = FALSE}
# Lectura de librerías
using DataFrames, CSV, Econometrics;
# Lectura de datos
INF_INT  = CSV.read("INF_INTERN.csv", DataFrame);
describe(INF_INT)
# Estimación MCO
modelo_MCO = fit(EconometricModel, @formula(INF ~ RM + RY), INF_INT)
# Estimación VI
modelo_VI = fit(EconometricModel, @formula(INF ~ RM + (RY ~ EDUC + INV + RPOB + YPC0)), INF_INT)
```
